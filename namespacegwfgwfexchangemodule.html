<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODFLOW 6: gwfgwfexchangemodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf6-triangular-grid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MODFLOW 6
   &#160;<span id="projectnumber">version 6.5.0</span>
   </div>
   <div id="projectbrief">MODFLOW 6 Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacegwfgwfexchangemodule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">gwfgwfexchangemodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains the GwfGwfExchangeModule Module.  
<a href="namespacegwfgwfexchangemodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derived type for GwfExchangeType.  <a href="structgwfgwfexchangemodule_1_1gwfexchangetype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8e8db965870b9878ff9fb5476227b92d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a8e8db965870b9878ff9fb5476227b92d">gwfexchange_create</a> (filename, name, id, m1_id, m2_id)</td></tr>
<tr class="memdesc:a8e8db965870b9878ff9fb5476227b92d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Create GWF GWF exchange  <a href="namespacegwfgwfexchangemodule.html#a8e8db965870b9878ff9fb5476227b92d">More...</a><br /></td></tr>
<tr class="separator:a8e8db965870b9878ff9fb5476227b92d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fd62a7c8068962d77882edcf4ff2216"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a8fd62a7c8068962d77882edcf4ff2216">gwf_gwf_df</a> (this)</td></tr>
<tr class="memdesc:a8fd62a7c8068962d77882edcf4ff2216"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Define GWF GWF exchange  <a href="namespacegwfgwfexchangemodule.html#a8fd62a7c8068962d77882edcf4ff2216">More...</a><br /></td></tr>
<tr class="separator:a8fd62a7c8068962d77882edcf4ff2216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabc561aefd93cdde87725dd7097e45f6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#aabc561aefd93cdde87725dd7097e45f6">validate_exchange</a> (this)</td></tr>
<tr class="memdesc:aabc561aefd93cdde87725dd7097e45f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">validate exchange data after reading  <a href="namespacegwfgwfexchangemodule.html#aabc561aefd93cdde87725dd7097e45f6">More...</a><br /></td></tr>
<tr class="separator:aabc561aefd93cdde87725dd7097e45f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a37ae59aa2825bfaa0a41bbe42af340"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a4a37ae59aa2825bfaa0a41bbe42af340">gwf_gwf_ac</a> (this, sparse)</td></tr>
<tr class="memdesc:a4a37ae59aa2825bfaa0a41bbe42af340"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Add connections  <a href="namespacegwfgwfexchangemodule.html#a4a37ae59aa2825bfaa0a41bbe42af340">More...</a><br /></td></tr>
<tr class="separator:a4a37ae59aa2825bfaa0a41bbe42af340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac02c06bb72ba58f133176a3bd49118f3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#ac02c06bb72ba58f133176a3bd49118f3">gwf_gwf_mc</a> (this, matrix_sln)</td></tr>
<tr class="memdesc:ac02c06bb72ba58f133176a3bd49118f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Map connections  <a href="namespacegwfgwfexchangemodule.html#ac02c06bb72ba58f133176a3bd49118f3">More...</a><br /></td></tr>
<tr class="separator:ac02c06bb72ba58f133176a3bd49118f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a606cd0dc2dc02ddd2d446b0cdbb829cb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a606cd0dc2dc02ddd2d446b0cdbb829cb">gwf_gwf_ar</a> (this)</td></tr>
<tr class="memdesc:a606cd0dc2dc02ddd2d446b0cdbb829cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate and read  <a href="namespacegwfgwfexchangemodule.html#a606cd0dc2dc02ddd2d446b0cdbb829cb">More...</a><br /></td></tr>
<tr class="separator:a606cd0dc2dc02ddd2d446b0cdbb829cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab6d07c651d179d57c04fa2e7db090d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a8ab6d07c651d179d57c04fa2e7db090d">gwf_gwf_rp</a> (this)</td></tr>
<tr class="memdesc:a8ab6d07c651d179d57c04fa2e7db090d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read and prepare  <a href="namespacegwfgwfexchangemodule.html#a8ab6d07c651d179d57c04fa2e7db090d">More...</a><br /></td></tr>
<tr class="separator:a8ab6d07c651d179d57c04fa2e7db090d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a11b7cb4368ba9093d012abb59d79b7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a6a11b7cb4368ba9093d012abb59d79b7">gwf_gwf_ad</a> (this)</td></tr>
<tr class="memdesc:a6a11b7cb4368ba9093d012abb59d79b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Advance  <a href="namespacegwfgwfexchangemodule.html#a6a11b7cb4368ba9093d012abb59d79b7">More...</a><br /></td></tr>
<tr class="separator:a6a11b7cb4368ba9093d012abb59d79b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5c32a037157730a5e812541155e6149"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#ac5c32a037157730a5e812541155e6149">gwf_gwf_cf</a> (this, kiter)</td></tr>
<tr class="memdesc:ac5c32a037157730a5e812541155e6149"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate coefficients  <a href="namespacegwfgwfexchangemodule.html#ac5c32a037157730a5e812541155e6149">More...</a><br /></td></tr>
<tr class="separator:ac5c32a037157730a5e812541155e6149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70c5db78158d40a4bb2de763715c5330"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a70c5db78158d40a4bb2de763715c5330">gwf_gwf_fc</a> (this, kiter, matrix_sln, rhs_sln, inwtflag)</td></tr>
<tr class="memdesc:a70c5db78158d40a4bb2de763715c5330"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill coefficients  <a href="namespacegwfgwfexchangemodule.html#a70c5db78158d40a4bb2de763715c5330">More...</a><br /></td></tr>
<tr class="separator:a70c5db78158d40a4bb2de763715c5330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c44a3ed85d7ffa16d5bda5e6062d990"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a6c44a3ed85d7ffa16d5bda5e6062d990">gwf_gwf_fn</a> (this, kiter, matrix_sln)</td></tr>
<tr class="memdesc:a6c44a3ed85d7ffa16d5bda5e6062d990"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Fill Newton  <a href="namespacegwfgwfexchangemodule.html#a6c44a3ed85d7ffa16d5bda5e6062d990">More...</a><br /></td></tr>
<tr class="separator:a6c44a3ed85d7ffa16d5bda5e6062d990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f4f7a596e1cf09b52235aa697a3278f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a1f4f7a596e1cf09b52235aa697a3278f">gwf_gwf_cq</a> (this, icnvg, isuppress_output, isolnid)</td></tr>
<tr class="memdesc:a1f4f7a596e1cf09b52235aa697a3278f"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate flow  <a href="namespacegwfgwfexchangemodule.html#a1f4f7a596e1cf09b52235aa697a3278f">More...</a><br /></td></tr>
<tr class="separator:a1f4f7a596e1cf09b52235aa697a3278f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d957087864e5e1d3c5e28a397450b7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#ad7d957087864e5e1d3c5e28a397450b7">gwf_gwf_calc_simvals</a> (this)</td></tr>
<tr class="memdesc:ad7d957087864e5e1d3c5e28a397450b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate flow rates for the exchanges and.  <a href="namespacegwfgwfexchangemodule.html#ad7d957087864e5e1d3c5e28a397450b7">More...</a><br /></td></tr>
<tr class="separator:ad7d957087864e5e1d3c5e28a397450b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f4e5e3e341caed61159f222d68a543b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a3f4e5e3e341caed61159f222d68a543b">gwf_gwf_add_to_flowja</a> (this)</td></tr>
<tr class="memdesc:a3f4e5e3e341caed61159f222d68a543b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add exchange flow to each model flowja diagonal.  <a href="namespacegwfgwfexchangemodule.html#a3f4e5e3e341caed61159f222d68a543b">More...</a><br /></td></tr>
<tr class="separator:a3f4e5e3e341caed61159f222d68a543b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa45d4bd831f936651854f0eb66e860f6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#aa45d4bd831f936651854f0eb66e860f6">gwf_gwf_set_flow_to_npf</a> (this)</td></tr>
<tr class="memdesc:aa45d4bd831f936651854f0eb66e860f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set flow rates to the edges in the models.  <a href="namespacegwfgwfexchangemodule.html#aa45d4bd831f936651854f0eb66e860f6">More...</a><br /></td></tr>
<tr class="separator:aa45d4bd831f936651854f0eb66e860f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71c2790d83529c51a5fee3fe1d9bdd04"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a71c2790d83529c51a5fee3fe1d9bdd04">gwf_gwf_bd</a> (this, icnvg, isuppress_output, isolnid)</td></tr>
<tr class="memdesc:a71c2790d83529c51a5fee3fe1d9bdd04"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Budget  <a href="namespacegwfgwfexchangemodule.html#a71c2790d83529c51a5fee3fe1d9bdd04">More...</a><br /></td></tr>
<tr class="separator:a71c2790d83529c51a5fee3fe1d9bdd04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ec5bb56392096a9e44e295ab31c4cf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a60ec5bb56392096a9e44e295ab31c4cf">gwf_gwf_bdsav</a> (this)</td></tr>
<tr class="memdesc:a60ec5bb56392096a9e44e295ab31c4cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Budget save  <a href="namespacegwfgwfexchangemodule.html#a60ec5bb56392096a9e44e295ab31c4cf">More...</a><br /></td></tr>
<tr class="separator:a60ec5bb56392096a9e44e295ab31c4cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd2e14cdc2fbc91cfdae11a6f4f61b09"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#acd2e14cdc2fbc91cfdae11a6f4f61b09">gwf_gwf_bdsav_model</a> (this, model)</td></tr>
<tr class="separator:acd2e14cdc2fbc91cfdae11a6f4f61b09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ade52e6073f558a747ab8802b1a694"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#aa5ade52e6073f558a747ab8802b1a694">gwf_gwf_ot</a> (this)</td></tr>
<tr class="memdesc:aa5ade52e6073f558a747ab8802b1a694"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Output  <a href="namespacegwfgwfexchangemodule.html#aa5ade52e6073f558a747ab8802b1a694">More...</a><br /></td></tr>
<tr class="separator:aa5ade52e6073f558a747ab8802b1a694"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30323e69d2dbc0705ceb951a73385b97"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a30323e69d2dbc0705ceb951a73385b97">read_options</a> (this, iout)</td></tr>
<tr class="memdesc:a30323e69d2dbc0705ceb951a73385b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read options  <a href="namespacegwfgwfexchangemodule.html#a30323e69d2dbc0705ceb951a73385b97">More...</a><br /></td></tr>
<tr class="separator:a30323e69d2dbc0705ceb951a73385b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a1a567692279b362a294d7b6b8ae971"><td class="memItemLeft" align="right" valign="top">logical(lgp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a3a1a567692279b362a294d7b6b8ae971">parse_option</a> (this, keyword, iout)</td></tr>
<tr class="memdesc:a3a1a567692279b362a294d7b6b8ae971"><td class="mdescLeft">&#160;</td><td class="mdescRight">parse option from exchange file  <a href="namespacegwfgwfexchangemodule.html#a3a1a567692279b362a294d7b6b8ae971">More...</a><br /></td></tr>
<tr class="separator:a3a1a567692279b362a294d7b6b8ae971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2993b4249a14302d26f1bc1613aa681"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#ae2993b4249a14302d26f1bc1613aa681">read_gnc</a> (this)</td></tr>
<tr class="memdesc:ae2993b4249a14302d26f1bc1613aa681"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read ghost nodes  <a href="namespacegwfgwfexchangemodule.html#ae2993b4249a14302d26f1bc1613aa681">More...</a><br /></td></tr>
<tr class="separator:ae2993b4249a14302d26f1bc1613aa681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc570e5db32482ada98b47690b1c92a5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#adc570e5db32482ada98b47690b1c92a5">read_mvr</a> (this, iout)</td></tr>
<tr class="memdesc:adc570e5db32482ada98b47690b1c92a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read mover  <a href="namespacegwfgwfexchangemodule.html#adc570e5db32482ada98b47690b1c92a5">More...</a><br /></td></tr>
<tr class="separator:adc570e5db32482ada98b47690b1c92a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d141cbfc501a53611ba7dafa3ed815d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a2d141cbfc501a53611ba7dafa3ed815d">rewet</a> (this, kiter)</td></tr>
<tr class="memdesc:a2d141cbfc501a53611ba7dafa3ed815d"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Rewet  <a href="namespacegwfgwfexchangemodule.html#a2d141cbfc501a53611ba7dafa3ed815d">More...</a><br /></td></tr>
<tr class="separator:a2d141cbfc501a53611ba7dafa3ed815d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52b3db305896e17bfabdfcd03235504d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a52b3db305896e17bfabdfcd03235504d">calc_cond_sat</a> (this)</td></tr>
<tr class="separator:a52b3db305896e17bfabdfcd03235504d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb483eb5e84ad0053aebe4b8b8d3093"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#adfb483eb5e84ad0053aebe4b8b8d3093">condcalc</a> (this)</td></tr>
<tr class="memdesc:adfb483eb5e84ad0053aebe4b8b8d3093"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate the conductance  <a href="namespacegwfgwfexchangemodule.html#adfb483eb5e84ad0053aebe4b8b8d3093">More...</a><br /></td></tr>
<tr class="separator:adfb483eb5e84ad0053aebe4b8b8d3093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a731ad8b774d83065fbb046b9183e0481"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a731ad8b774d83065fbb046b9183e0481">allocate_scalars</a> (this)</td></tr>
<tr class="memdesc:a731ad8b774d83065fbb046b9183e0481"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate scalars  <a href="namespacegwfgwfexchangemodule.html#a731ad8b774d83065fbb046b9183e0481">More...</a><br /></td></tr>
<tr class="separator:a731ad8b774d83065fbb046b9183e0481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed9e3680ace89214a3a9eb885dcf81b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a7ed9e3680ace89214a3a9eb885dcf81b">gwf_gwf_da</a> (this)</td></tr>
<tr class="memdesc:a7ed9e3680ace89214a3a9eb885dcf81b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Deallocate  <a href="namespacegwfgwfexchangemodule.html#a7ed9e3680ace89214a3a9eb885dcf81b">More...</a><br /></td></tr>
<tr class="separator:a7ed9e3680ace89214a3a9eb885dcf81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2860ed405089c45dac142a5a20033c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#aaa2860ed405089c45dac142a5a20033c">allocate_arrays</a> (this)</td></tr>
<tr class="memdesc:aaa2860ed405089c45dac142a5a20033c"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Allocate arrays  <a href="namespacegwfgwfexchangemodule.html#aaa2860ed405089c45dac142a5a20033c">More...</a><br /></td></tr>
<tr class="separator:aaa2860ed405089c45dac142a5a20033c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa08b9ac097989c218665f87c84998a6e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#aa08b9ac097989c218665f87c84998a6e">gwf_gwf_df_obs</a> (this)</td></tr>
<tr class="memdesc:aa08b9ac097989c218665f87c84998a6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Define observations  <a href="namespacegwfgwfexchangemodule.html#aa08b9ac097989c218665f87c84998a6e">More...</a><br /></td></tr>
<tr class="separator:aa08b9ac097989c218665f87c84998a6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8642d52730bcecfc8d9c00926d5a8d4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#ab8642d52730bcecfc8d9c00926d5a8d4">gwf_gwf_rp_obs</a> (this)</td></tr>
<tr class="memdesc:ab8642d52730bcecfc8d9c00926d5a8d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Read and prepare observations  <a href="namespacegwfgwfexchangemodule.html#ab8642d52730bcecfc8d9c00926d5a8d4">More...</a><br /></td></tr>
<tr class="separator:ab8642d52730bcecfc8d9c00926d5a8d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a152f734583a3af9255fd29d4ccde2eee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a152f734583a3af9255fd29d4ccde2eee">gwf_gwf_fp</a> (this)</td></tr>
<tr class="memdesc:a152f734583a3af9255fd29d4ccde2eee"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Final processing  <a href="namespacegwfgwfexchangemodule.html#a152f734583a3af9255fd29d4ccde2eee">More...</a><br /></td></tr>
<tr class="separator:a152f734583a3af9255fd29d4ccde2eee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc7c47193c0fffea6eb6ca80987d93e"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a8dc7c47193c0fffea6eb6ca80987d93e">qcalc</a> (this, iexg, n1, n2)</td></tr>
<tr class="memdesc:a8dc7c47193c0fffea6eb6ca80987d93e"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Calculate flow  <a href="namespacegwfgwfexchangemodule.html#a8dc7c47193c0fffea6eb6ca80987d93e">More...</a><br /></td></tr>
<tr class="separator:a8dc7c47193c0fffea6eb6ca80987d93e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de8a3892605167994d5df3995c0d6a3"><td class="memItemLeft" align="right" valign="top">integer(i4b) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a0de8a3892605167994d5df3995c0d6a3">gwf_gwf_get_iasym</a> (this)</td></tr>
<tr class="memdesc:a0de8a3892605167994d5df3995c0d6a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Set symmetric flag  <a href="namespacegwfgwfexchangemodule.html#a0de8a3892605167994d5df3995c0d6a3">More...</a><br /></td></tr>
<tr class="separator:a0de8a3892605167994d5df3995c0d6a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa32abf1b9eb9d1a338b627696bddaefb"><td class="memItemLeft" align="right" valign="top">logical(lgp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#aa32abf1b9eb9d1a338b627696bddaefb">gwf_gwf_connects_model</a> (this, model)</td></tr>
<tr class="memdesc:aa32abf1b9eb9d1a338b627696bddaefb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true when this exchange provides matrix coefficients for solving.  <a href="namespacegwfgwfexchangemodule.html#aa32abf1b9eb9d1a338b627696bddaefb">More...</a><br /></td></tr>
<tr class="separator:aa32abf1b9eb9d1a338b627696bddaefb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ee21a7bd938104b56658f93949ef2f3"><td class="memItemLeft" align="right" valign="top">logical(lgp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a5ee21a7bd938104b56658f93949ef2f3">use_interface_model</a> (this)</td></tr>
<tr class="memdesc:a5ee21a7bd938104b56658f93949ef2f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should interface model be used for this exchange.  <a href="namespacegwfgwfexchangemodule.html#a5ee21a7bd938104b56658f93949ef2f3">More...</a><br /></td></tr>
<tr class="separator:a5ee21a7bd938104b56658f93949ef2f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d20dd3801d4fc9fe96c67b0ed02448b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a4d20dd3801d4fc9fe96c67b0ed02448b">gwf_gwf_save_simvals</a> (this)</td></tr>
<tr class="memdesc:a4d20dd3801d4fc9fe96c67b0ed02448b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Save simulated flow observations  <a href="namespacegwfgwfexchangemodule.html#a4d20dd3801d4fc9fe96c67b0ed02448b">More...</a><br /></td></tr>
<tr class="separator:a4d20dd3801d4fc9fe96c67b0ed02448b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a239e8be3dbc3db266c6a1ddac648bd5b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a239e8be3dbc3db266c6a1ddac648bd5b">gwf_gwf_process_obsid</a> (obsrv, dis, inunitobs, iout)</td></tr>
<tr class="memdesc:a239e8be3dbc3db266c6a1ddac648bd5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Obs ID processer  <a href="namespacegwfgwfexchangemodule.html#a239e8be3dbc3db266c6a1ddac648bd5b">More...</a><br /></td></tr>
<tr class="separator:a239e8be3dbc3db266c6a1ddac648bd5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac43e7dbf0b8ccd7642cbc9a28badd77"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>) function, pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#aac43e7dbf0b8ccd7642cbc9a28badd77">castasgwfexchange</a> (obj)</td></tr>
<tr class="memdesc:aac43e7dbf0b8ccd7642cbc9a28badd77"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Cast polymorphic object as exchange  <a href="namespacegwfgwfexchangemodule.html#aac43e7dbf0b8ccd7642cbc9a28badd77">More...</a><br /></td></tr>
<tr class="separator:aac43e7dbf0b8ccd7642cbc9a28badd77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a212a97d08a5d235f4aa6a96c92e715fa"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>) function, pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegwfgwfexchangemodule.html#a212a97d08a5d235f4aa6a96c92e715fa">getgwfexchangefromlist</a> (list, idx)</td></tr>
<tr class="memdesc:a212a97d08a5d235f4aa6a96c92e715fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">@ brief Get exchange from list  <a href="namespacegwfgwfexchangemodule.html#a212a97d08a5d235f4aa6a96c92e715fa">More...</a><br /></td></tr>
<tr class="separator:a212a97d08a5d235f4aa6a96c92e715fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains the code for connecting two GWF Models. The methods are based on the simple two point flux approximation with the option to use ghost nodes to improve accuracy. This exchange is used by GwfGwfConnection with the more sophisticated interface model coupling approach when XT3D is needed. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aaa2860ed405089c45dac142a5a20033c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa2860ed405089c45dac142a5a20033c">&#9670;&nbsp;</a></span>allocate_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::allocate_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate arrays </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01829">1829</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: text</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabcol, i</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="keyword">call </span>this%DisConnExchangeType%allocate_arrays()</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%cond, this%nexg, <span class="stringliteral">&#39;COND&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idxglo, this%nexg, <span class="stringliteral">&#39;IDXGLO&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idxsymglo, this%nexg, <span class="stringliteral">&#39;IDXSYMGLO&#39;</span>, this%memoryPath) <span class="comment">!</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%condsat, this%nexg, <span class="stringliteral">&#39;CONDSAT&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%simvals, this%nexg, <span class="stringliteral">&#39;SIMVALS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nexg</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      this%cond(i) = dnodata</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">! -- allocate and initialize the output table</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">if</span> (this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <span class="comment">! -- dimension table</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      ntabcol = 3</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        ntabcol = ntabcol + 1</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="comment">! -- initialize the output table objects</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="comment">!    outouttab1</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">if</span> (this%v_model1%is_local) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keyword">call </span>table_cr(this%outputtab1, this%name, <span class="stringliteral">&#39;    &#39;</span>)</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="keyword">call </span>this%outputtab1%table_df(this%nexg, ntabcol, this%gwfmodel1%iout, &amp;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                                      transient=.true.)</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        text = <span class="stringliteral">&#39;NUMBER&#39;</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <span class="keyword">call </span>this%outputtab1%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        text = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="keyword">call </span>this%outputtab1%initialize_column(text, 20, alignment=tableft)</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        text = <span class="stringliteral">&#39;RATE&#39;</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        <span class="keyword">call </span>this%outputtab1%initialize_column(text, 15, alignment=tabcenter)</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        <span class="keywordflow">if</span> (this%inamedbound &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;          text = <span class="stringliteral">&#39;NAME&#39;</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;          <span class="keyword">call </span>this%outputtab1%initialize_column(text, 20, alignment=tableft)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="comment">!    outouttab2</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keywordflow">if</span> (this%v_model2%is_local) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="keyword">call </span>table_cr(this%outputtab2, this%name, <span class="stringliteral">&#39;    &#39;</span>)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        <span class="keyword">call </span>this%outputtab2%table_df(this%nexg, ntabcol, this%gwfmodel2%iout, &amp;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                                      transient=.true.)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        text = <span class="stringliteral">&#39;NUMBER&#39;</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        <span class="keyword">call </span>this%outputtab2%initialize_column(text, 10, alignment=tabcenter)</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        text = <span class="stringliteral">&#39;CELLID&#39;</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keyword">call </span>this%outputtab2%initialize_column(text, 20, alignment=tableft)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        text = <span class="stringliteral">&#39;RATE&#39;</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <span class="keyword">call </span>this%outputtab2%initialize_column(text, 15, alignment=tabcenter)</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="keywordflow">if</span> (this%inamedbound &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;          text = <span class="stringliteral">&#39;NAME&#39;</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;          <span class="keyword">call </span>this%outputtab2%initialize_column(text, 20, alignment=tableft)</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__allocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__allocate.html">memorymanagermodule::mem_allocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00050">MemoryManager.f90:50</a></div></div>
<div class="ttc" id="anamespacememorymanagermodule_html"><div class="ttname"><a href="namespacememorymanagermodule.html">memorymanagermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00001">MemoryManager.f90:1</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_aaa2860ed405089c45dac142a5a20033c_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_aaa2860ed405089c45dac142a5a20033c_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_aaa2860ed405089c45dac142a5a20033c_cgraph" id="anamespacegwfgwfexchangemodule_aaa2860ed405089c45dac142a5a20033c_cgraph">
<area shape="rect" title="@ brief Allocate arrays" alt="" coords="5,5,188,47"/>
<area shape="rect" href="namespacetablemodule.html#a7632d784ec9e94277a76705ef56725f2" title=" " alt="" coords="236,13,400,39"/>
</map>
</div>

</div>
</div>
<a id="a731ad8b774d83065fbb046b9183e0481"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a731ad8b774d83065fbb046b9183e0481">&#9670;&nbsp;</a></span>allocate_scalars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::allocate_scalars </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate scalar variables </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01723">1723</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keyword">call </span>this%DisConnExchangeType%allocate_scalars()</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%iprflow, <span class="stringliteral">&#39;IPRFLOW&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ipakcb, <span class="stringliteral">&#39;IPAKCB&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    this%iprpak = 0</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    this%iprflow = 0</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    this%ipakcb = 0</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%icellavg, <span class="stringliteral">&#39;ICELLAVG&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ivarcv, <span class="stringliteral">&#39;IVARCV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%idewatcv, <span class="stringliteral">&#39;IDEWATCV&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%inewton, <span class="stringliteral">&#39;INEWTON&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%ingnc, <span class="stringliteral">&#39;INGNC&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%inmvr, <span class="stringliteral">&#39;INMVR&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%inobs, <span class="stringliteral">&#39;INOBS&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a>(this%satomega, <span class="stringliteral">&#39;SATOMEGA&#39;</span>, this%memoryPath)</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    this%icellavg = 0</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    this%ivarcv = 0</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    this%idewatcv = 0</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    this%inewton = 0</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    this%ingnc = 0</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    this%inmvr = 0</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    this%inobs = 0</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    this%satomega = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespaceconstantsmodule_html"><div class="ttname"><a href="namespaceconstantsmodule.html">constantsmodule</a></div><div class="ttdoc">This module contains simulation constants.</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00009">Constants.f90:9</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_abab5757666b9ddd2726c20ce48dd0050"><div class="ttname"><a href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">constantsmodule::dzero</a></div><div class="ttdeci">real(dp), parameter dzero</div><div class="ttdoc">real constant zero</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00062">Constants.f90:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a52b3db305896e17bfabdfcd03235504d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52b3db305896e17bfabdfcd03235504d">&#9670;&nbsp;</a></span>calc_cond_sat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::calc_cond_sat </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01535">1535</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a>, <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#a9262b16d485352c5d369c6cb86232c60">dhalf</a>, <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>, <a class="code" href="namespaceconstantsmodule.html#aa782c151085f5c3c4892ecb72cdda2ce">dpio180</a></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegwfnpfmodule.html">gwfnpfmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacegwfnpfmodule.html#ae3238216f84434bb2862e840a6ebeb00">condmean</a>, <a class="code" href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e">vcond</a>, <a class="code" href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209">hcond</a></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iexg</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, m, ihc</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="keywordtype">    real</span>(DP) :: topn, topm</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="keywordtype">    real</span>(DP) :: botn, botm</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="keywordtype">    real</span>(DP) :: satn, satm</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="keywordtype">    real</span>(DP) :: thickn, thickm</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="keywordtype">    real</span>(DP) :: angle, hyn, hym</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="keywordtype">    real</span>(DP) :: csat</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="keywordtype">    real</span>(DP) :: fawidth</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(3)</span> :: vg</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordflow">do</span> iexg = 1, this%nexg</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      ihc = this%ihc(iexg)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      n = this%nodem1(iexg)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      m = this%nodem2(iexg)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      topn = this%gwfmodel1%dis%top(n)</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      topm = this%gwfmodel2%dis%top(m)</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      botn = this%gwfmodel1%dis%bot(n)</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      botm = this%gwfmodel2%dis%bot(m)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      satn = this%gwfmodel1%npf%sat(n)</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      satm = this%gwfmodel2%npf%sat(m)</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      thickn = (topn - botn) * satn</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      thickm = (topm - botm) * satm</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="comment">! -- Calculate conductance depending on connection orientation</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="keywordflow">if</span> (ihc == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="comment">! -- Vertical conductance for fully saturated conditions</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        vg(1) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        vg(2) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        vg(3) = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        hyn = this%gwfmodel1%npf%hy_eff(n, 0, ihc, vg=vg)</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        hym = this%gwfmodel2%npf%hy_eff(m, 0, ihc, vg=vg)</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        csat = <a class="code" href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e">vcond</a>(1, 1, 1, 1, 0, 1, 1, <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>, &amp;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                     botn, botm, &amp;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                     hyn, hym, &amp;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                     satn, satm, &amp;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                     topn, topm, &amp;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                     botn, botm, &amp;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                     this%hwva(iexg))</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="comment">! -- Calculate horizontal conductance</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        hyn = this%gwfmodel1%npf%k11(n)</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        hym = this%gwfmodel2%npf%k11(m)</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="comment">! -- Check for anisotropy in models, and recalculate hyn and hym</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="keywordflow">if</span> (this%ianglex &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;          angle = this%auxvar(this%ianglex, iexg) * <a class="code" href="namespaceconstantsmodule.html#aa782c151085f5c3c4892ecb72cdda2ce">dpio180</a></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;          vg(1) = abs(cos(angle))</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;          vg(2) = abs(sin(angle))</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;          vg(3) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;          <span class="comment">! -- anisotropy in model 1</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;          <span class="keywordflow">if</span> (this%gwfmodel1%npf%ik22 /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            hyn = this%gwfmodel1%npf%hy_eff(n, 0, ihc, vg=vg)</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;          <span class="comment">! -- anisotropy in model 2</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;          <span class="keywordflow">if</span> (this%gwfmodel2%npf%ik22 /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            hym = this%gwfmodel2%npf%hy_eff(m, 0, ihc, vg=vg)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        fawidth = this%hwva(iexg)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        csat = <a class="code" href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209">hcond</a>(1, 1, 1, 1, this%inewton, 0, ihc, &amp;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                     this%icellavg, 0, 0, <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a>, &amp;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                     topn, topm, satn, satm, hyn, hym, &amp;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                     topn, topm, &amp;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                     botn, botm, &amp;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                     this%cl1(iexg), this%cl2(iexg), &amp;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                     fawidth, this%satomega)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="comment">! -- store csat in condsat</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      this%condsat(iexg) = csat</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="ttc" id="anamespaceconstantsmodule_html_a060d310ded5535ce2dc85bd1ca1afd3d"><div class="ttname"><a href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">constantsmodule::linelength</a></div><div class="ttdeci">integer(i4b), parameter linelength</div><div class="ttdoc">maximum length of a standard line</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00044">Constants.f90:44</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a9262b16d485352c5d369c6cb86232c60"><div class="ttname"><a href="namespaceconstantsmodule.html#a9262b16d485352c5d369c6cb86232c60">constantsmodule::dhalf</a></div><div class="ttdeci">real(dp), parameter dhalf</div><div class="ttdoc">real constant 1/2</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00065">Constants.f90:65</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_aa782c151085f5c3c4892ecb72cdda2ce"><div class="ttname"><a href="namespaceconstantsmodule.html#aa782c151085f5c3c4892ecb72cdda2ce">constantsmodule::dpio180</a></div><div class="ttdeci">real(dp), parameter dpio180</div><div class="ttdoc">real constant</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00119">Constants.f90:119</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_af918ac22cd0b232deea67660bfbc9ce1"><div class="ttname"><a href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">constantsmodule::done</a></div><div class="ttdeci">real(dp), parameter done</div><div class="ttdoc">real constant 1</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00073">Constants.f90:73</a></div></div>
<div class="ttc" id="anamespacegwfnpfmodule_html"><div class="ttname"><a href="namespacegwfnpfmodule.html">gwfnpfmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3npf8_8f90_source.html#l00001">gwf3npf8.f90:1</a></div></div>
<div class="ttc" id="anamespacegwfnpfmodule_html_a0ac64188c68a16279d975e588393259e"><div class="ttname"><a href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e">gwfnpfmodule::vcond</a></div><div class="ttdeci">real(dp) function, public vcond(ibdn, ibdm, ictn, ictm, inewton, ivarcv, idewatcv, condsat, hn, hm, vkn, vkm, satn, satm, topn, topm, botn, botm, flowarea)</div><div class="ttdef"><b>Definition:</b> <a href="gwf3npf8_8f90_source.html#l02814">gwf3npf8.f90:2817</a></div></div>
<div class="ttc" id="anamespacegwfnpfmodule_html_a7fc55c137cbf452e811e7bda474af209"><div class="ttname"><a href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209">gwfnpfmodule::hcond</a></div><div class="ttdeci">real(dp) function, public hcond(ibdn, ibdm, ictn, ictm, inewton, inwtup, ihc, icellavg, iusg, iupw, condsat, hn, hm, satn, satm, hkn, hkm, topn, topm, botn, botm, cln, clm, fawidth, satomega, satminopt)</div><div class="ttdef"><b>Definition:</b> <a href="gwf3npf8_8f90_source.html#l02647">gwf3npf8.f90:2651</a></div></div>
<div class="ttc" id="anamespacegwfnpfmodule_html_ae3238216f84434bb2862e840a6ebeb00"><div class="ttname"><a href="namespacegwfnpfmodule.html#ae3238216f84434bb2862e840a6ebeb00">gwfnpfmodule::condmean</a></div><div class="ttdeci">real(dp) function, public condmean(k1, k2, thick1, thick2, cl1, cl2, width, iavgmeth)</div><div class="ttdef"><b>Definition:</b> <a href="gwf3npf8_8f90_source.html#l02900">gwf3npf8.f90:2901</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a52b3db305896e17bfabdfcd03235504d_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a52b3db305896e17bfabdfcd03235504d_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a52b3db305896e17bfabdfcd03235504d_cgraph" id="anamespacegwfgwfexchangemodule_a52b3db305896e17bfabdfcd03235504d_cgraph">
<area shape="rect" title=" " alt="" coords="5,49,188,90"/>
<area shape="rect" href="namespacegwfnpfmodule.html#ae3238216f84434bb2862e840a6ebeb00" title=" " alt="" coords="492,5,684,32"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209" title=" " alt="" coords="236,56,399,83"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e" title=" " alt="" coords="236,107,399,133"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a905d9a528c4d4a783096b639298d42b3" title=" " alt="" coords="777,5,959,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#a4be083cd9964c682d55802ff9bc436bc" title=" " alt="" coords="447,56,729,83"/>
</map>
</div>

</div>
</div>
<a id="aac43e7dbf0b8ccd7642cbc9a28badd77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac43e7dbf0b8ccd7642cbc9a28badd77">&#9670;&nbsp;</a></span>castasgwfexchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>) function, pointer, public gwfgwfexchangemodule::castasgwfexchange </td>
          <td>(</td>
          <td class="paramtype">class(*), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cast polymorphic object as exchange </p>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l02182">2182</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: obj</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType), <span class="keywordtype">pointer</span> :: res</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    res =&gt; null()</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(obj)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keywordflow">select type</span> (obj)</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="keywordflow">    class is</span> (gwfexchangetype)</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;      res =&gt; obj</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_aac43e7dbf0b8ccd7642cbc9a28badd77_icgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_aac43e7dbf0b8ccd7642cbc9a28badd77_icgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_aac43e7dbf0b8ccd7642cbc9a28badd77_icgraph" id="anamespacegwfgwfexchangemodule_aac43e7dbf0b8ccd7642cbc9a28badd77_icgraph">
<area shape="rect" title="@ brief Cast polymorphic object as exchange" alt="" coords="483,43,665,84"/>
<area shape="rect" href="namespacegwfgwfexchangemodule.html#a212a97d08a5d235f4aa6a96c92e715fa" title="@ brief Get exchange from list" alt="" coords="245,8,434,49"/>
<area shape="rect" href="namespacegwfgwfconnectionmodule.html#adf69ded6447b65b3eea555039e4ae491" title="Basic construction of the connection." alt="" coords="244,75,435,116"/>
<area shape="rect" href="namespacegwfgwtexchangemodule.html#a186c9181959e0a9abaa5eca74675574a" title="Link GWT connections to GWF connections or exchanges." alt="" coords="9,5,192,47"/>
<area shape="rect" href="structgwfgwfconnectionmodule_1_1gwfgwfconnectiontype.html#a781048d4e008b7a7adfb445f7071796a" title=" " alt="" coords="5,71,196,127"/>
</map>
</div>

</div>
</div>
<a id="adfb483eb5e84ad0053aebe4b8b8d3093"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb483eb5e84ad0053aebe4b8b8d3093">&#9670;&nbsp;</a></span>condcalc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::condcalc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the conductance based on state </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01628">1628</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a9262b16d485352c5d369c6cb86232c60">dhalf</a>, <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegwfnpfmodule.html">gwfnpfmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209">hcond</a>, <a class="code" href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e">vcond</a></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iexg</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, m, ihc</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibdn, ibdm</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ictn, ictm</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="keywordtype">    real</span>(DP) :: topn, topm</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="keywordtype">    real</span>(DP) :: botn, botm</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="keywordtype">    real</span>(DP) :: satn, satm</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="keywordtype">    real</span>(DP) :: hyn, hym</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="keywordtype">    real</span>(DP) :: angle</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="keywordtype">    real</span>(DP) :: hn, hm</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keywordtype">    real</span>(DP) :: cond</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="keywordtype">    real</span>(DP) :: fawidth</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(3)</span> :: vg</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="comment">! -- Calculate conductance and put into amat</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordflow">do</span> iexg = 1, this%nexg</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      ihc = this%ihc(iexg)</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      n = this%nodem1(iexg)</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      m = this%nodem2(iexg)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      ibdn = this%gwfmodel1%ibound(n)</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      ibdm = this%gwfmodel2%ibound(m)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      ictn = this%gwfmodel1%npf%icelltype(n)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      ictm = this%gwfmodel2%npf%icelltype(m)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      topn = this%gwfmodel1%dis%top(n)</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      topm = this%gwfmodel2%dis%top(m)</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      botn = this%gwfmodel1%dis%bot(n)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      botm = this%gwfmodel2%dis%bot(m)</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      satn = this%gwfmodel1%npf%sat(n)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      satm = this%gwfmodel2%npf%sat(m)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      hn = this%gwfmodel1%x(n)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      hm = this%gwfmodel2%x(m)</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <span class="comment">! -- Calculate conductance depending on connection orientation</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <span class="keywordflow">if</span> (ihc == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="comment">! -- Vertical connection</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        vg(1) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        vg(2) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        vg(3) = <a class="code" href="namespaceconstantsmodule.html#af918ac22cd0b232deea67660bfbc9ce1">done</a></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        hyn = this%gwfmodel1%npf%hy_eff(n, 0, ihc, vg=vg)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        hym = this%gwfmodel2%npf%hy_eff(m, 0, ihc, vg=vg)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        cond = <a class="code" href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e">vcond</a>(ibdn, ibdm, ictn, ictm, this%inewton, this%ivarcv, &amp;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                     this%idewatcv, this%condsat(iexg), hn, hm, hyn, hym, &amp;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                     satn, satm, topn, topm, botn, botm, this%hwva(iexg))</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="comment">! -- Horizontal Connection</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        hyn = this%gwfmodel1%npf%k11(n)</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        hym = this%gwfmodel2%npf%k11(m)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="comment">! -- Check for anisotropy in models, and recalculate hyn and hym</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keywordflow">if</span> (this%ianglex &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;          angle = this%auxvar(this%ianglex, iexg)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;          vg(1) = abs(cos(angle))</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;          vg(2) = abs(sin(angle))</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;          vg(3) = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;          <span class="comment">! -- anisotropy in model 1</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;          <span class="keywordflow">if</span> (this%gwfmodel1%npf%ik22 /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            hyn = this%gwfmodel1%npf%hy_eff(n, 0, ihc, vg=vg)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;          <span class="comment">! -- anisotropy in model 2</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;          <span class="keywordflow">if</span> (this%gwfmodel2%npf%ik22 /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            hym = this%gwfmodel2%npf%hy_eff(m, 0, ihc, vg=vg)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        fawidth = this%hwva(iexg)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        cond = <a class="code" href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209">hcond</a>(ibdn, ibdm, ictn, ictm, this%inewton, this%inewton, &amp;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                     this%ihc(iexg), this%icellavg, 0, 0, this%condsat(iexg), &amp;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                     hn, hm, satn, satm, hyn, hym, topn, topm, botn, botm, &amp;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                     this%cl1(iexg), this%cl2(iexg), fawidth, this%satomega)</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      this%cond(iexg) = cond</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_adfb483eb5e84ad0053aebe4b8b8d3093_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_adfb483eb5e84ad0053aebe4b8b8d3093_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_adfb483eb5e84ad0053aebe4b8b8d3093_cgraph" id="anamespacegwfgwfexchangemodule_adfb483eb5e84ad0053aebe4b8b8d3093_cgraph">
<area shape="rect" title="@ brief Calculate the conductance" alt="" coords="5,49,188,90"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209" title=" " alt="" coords="236,31,399,57"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e" title=" " alt="" coords="236,81,399,108"/>
<area shape="rect" href="namespacegwfnpfmodule.html#ae3238216f84434bb2862e840a6ebeb00" title=" " alt="" coords="492,5,684,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#a4be083cd9964c682d55802ff9bc436bc" title=" " alt="" coords="447,56,729,83"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a905d9a528c4d4a783096b639298d42b3" title=" " alt="" coords="777,5,959,32"/>
</map>
</div>

</div>
</div>
<a id="a212a97d08a5d235f4aa6a96c92e715fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a212a97d08a5d235f4aa6a96c92e715fa">&#9670;&nbsp;</a></span>getgwfexchangefromlist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>) function, pointer, public gwfgwfexchangemodule::getgwfexchangefromlist </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structlistmodule_1_1listtype.html">listtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return an exchange from the list for specified index </p>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l02202">2202</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="keywordtype">type</span>(ListType), <span class="keywordtype">intent(inout)</span> :: list</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: idx</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType), <span class="keywordtype">pointer</span> :: res</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="keywordtype">class</span>(*), <span class="keywordtype">pointer</span> :: obj</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    obj =&gt; list%GetItem(idx)</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    res =&gt; castasgwfexchange(obj)</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a212a97d08a5d235f4aa6a96c92e715fa_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a212a97d08a5d235f4aa6a96c92e715fa_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a212a97d08a5d235f4aa6a96c92e715fa_cgraph" id="anamespacegwfgwfexchangemodule_a212a97d08a5d235f4aa6a96c92e715fa_cgraph">
<area shape="rect" title="@ brief Get exchange from list" alt="" coords="5,5,195,47"/>
<area shape="rect" href="namespacegwfgwfexchangemodule.html#aac43e7dbf0b8ccd7642cbc9a28badd77" title="@ brief Cast polymorphic object as exchange" alt="" coords="243,5,425,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a212a97d08a5d235f4aa6a96c92e715fa_icgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a212a97d08a5d235f4aa6a96c92e715fa_icgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a212a97d08a5d235f4aa6a96c92e715fa_icgraph" id="anamespacegwfgwfexchangemodule_a212a97d08a5d235f4aa6a96c92e715fa_icgraph">
<area shape="rect" title="@ brief Get exchange from list" alt="" coords="236,5,425,47"/>
<area shape="rect" href="namespacegwfgwtexchangemodule.html#a186c9181959e0a9abaa5eca74675574a" title="Link GWT connections to GWF connections or exchanges." alt="" coords="5,5,188,47"/>
</map>
</div>

</div>
</div>
<a id="a4a37ae59aa2825bfaa0a41bbe42af340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a37ae59aa2825bfaa0a41bbe42af340">&#9670;&nbsp;</a></span>gwf_gwf_ac()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_ac </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsparsemodule_1_1sparsematrix.html">sparsematrix</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>sparse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>override parent exg_ac so that gnc can add connections here. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00380">380</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesparsemodule.html">sparsemodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structsparsemodule_1_1sparsematrix.html">sparsematrix</a></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">type</span>(sparsematrix), <span class="keywordtype">intent(inout)</span> :: sparse</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, iglo, jglo</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">! -- add exchange connections</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">do</span> n = 1, this%nexg</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      iglo = this%nodem1(n) + this%gwfmodel1%moffset</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      jglo = this%nodem2(n) + this%gwfmodel2%moffset</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keyword">call </span>sparse%addconnection(iglo, jglo, 1)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keyword">call </span>sparse%addconnection(jglo, iglo, 1)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">! -- add gnc connections</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keyword">call </span>this%gnc%gnc_ac(sparse)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacesparsemodule_html"><div class="ttname"><a href="namespacesparsemodule.html">sparsemodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_sparse_8f90_source.html#l00001">Sparse.f90:1</a></div></div>
<div class="ttc" id="astructsparsemodule_1_1sparsematrix_html"><div class="ttname"><a href="structsparsemodule_1_1sparsematrix.html">sparsemodule::sparsematrix</a></div><div class="ttdef"><b>Definition:</b> <a href="_sparse_8f90_source.html#l00014">Sparse.f90:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a11b7cb4368ba9093d012abb59d79b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a11b7cb4368ba9093d012abb59d79b7">&#9670;&nbsp;</a></span>gwf_gwf_ad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_ad </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance mover and obs </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00489">489</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">! -- Advance mover</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keyword">call </span>this%mvr%mvr_ad()</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">! -- Push simulated values to preceding time step</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keyword">call </span>this%obs%obs_ad()</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f4e5e3e341caed61159f222d68a543b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f4e5e3e341caed61159f222d68a543b">&#9670;&nbsp;</a></span>gwf_gwf_add_to_flowja()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_add_to_flowja </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00765">765</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: idiag</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keywordtype">    real</span>(DP) :: flow</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nexg</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        flow = this%simvals(i)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        n = this%nodem1(i)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        idiag = this%gwfmodel1%ia(n)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        this%gwfmodel1%flowja(idiag) = this%gwfmodel1%flowja(idiag) + flow</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        flow = -this%simvals(i)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        n = this%nodem2(i)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        idiag = this%gwfmodel2%ia(n)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        this%gwfmodel2%flowja(idiag) = this%gwfmodel2%flowja(idiag) + flow</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a606cd0dc2dc02ddd2d446b0cdbb829cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a606cd0dc2dc02ddd2d446b0cdbb829cb">&#9670;&nbsp;</a></span>gwf_gwf_ar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_ar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocated and read and calculate saturated conductance </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00442">442</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">! -- If mover is active, then call ar routine</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keyword">call </span>this%mvr%mvr_ar()</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">! -- Calculate the saturated conductance for all connections</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (.not. this%use_interface_model()) <span class="keyword">call </span>this%calc_cond_sat()</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">! -- Observation AR</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keyword">call </span>this%obs%obs_ar()</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71c2790d83529c51a5fee3fe1d9bdd04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71c2790d83529c51a5fee3fe1d9bdd04">&#9670;&nbsp;</a></span>gwf_gwf_bd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_bd </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>icnvg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isuppress_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isolnid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Accumulate budget terms </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00912">912</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#adda4cd91b9096b31d5e48d2215359311">lenbudtxt</a>, <a class="code" href="namespaceconstantsmodule.html#a2e75f10abe62e57d87d7d468c2bf763d">lenpackagename</a></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebudgetmodule.html">budgetmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: icnvg</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isuppress_output</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isolnid</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(1)</span> :: budtxt</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(2, 1)</span> :: budterm</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keywordtype">    real</span>(DP) :: ratin, ratout</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    budtxt(1) = <span class="stringliteral">&#39;    FLOW-JA-FACE&#39;</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">! -- Calculate ratin/ratout and pass to model budgets</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">rate_accumulator</a>(this%simvals, ratin, ratout)</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">! -- Add the budget terms to model 1</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      budterm(1, 1) = ratin</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      budterm(2, 1) = ratout</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keyword">call </span>this%gwfmodel1%model_bdentry(budterm, budtxt, this%name)</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">! -- Add the budget terms to model 2</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      budterm(1, 1) = ratout</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      budterm(2, 1) = ratin</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="keyword">call </span>this%gwfmodel2%model_bdentry(budterm, budtxt, this%name)</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">! -- Call mvr bd routine</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keyword">call </span>this%mvr%mvr_bd()</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacebudgetmodule_html"><div class="ttname"><a href="namespacebudgetmodule.html">budgetmodule</a></div><div class="ttdoc">This module contains the BudgetModule.</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00020">Budget.f90:20</a></div></div>
<div class="ttc" id="anamespacebudgetmodule_html_a917d4897942de165ea88d0c1f0850d8e"><div class="ttname"><a href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e">budgetmodule::rate_accumulator</a></div><div class="ttdeci">subroutine, public rate_accumulator(flow, rin, rout)</div><div class="ttdoc">@ brief Rate accumulator subroutine</div><div class="ttdef"><b>Definition:</b> <a href="_budget_8f90_source.html#l00651">Budget.f90:652</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a2e75f10abe62e57d87d7d468c2bf763d"><div class="ttname"><a href="namespaceconstantsmodule.html#a2e75f10abe62e57d87d7d468c2bf763d">constantsmodule::lenpackagename</a></div><div class="ttdeci">integer(i4b), parameter lenpackagename</div><div class="ttdoc">maximum length of the package name</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00022">Constants.f90:22</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_adda4cd91b9096b31d5e48d2215359311"><div class="ttname"><a href="namespaceconstantsmodule.html#adda4cd91b9096b31d5e48d2215359311">constantsmodule::lenbudtxt</a></div><div class="ttdeci">integer(i4b), parameter lenbudtxt</div><div class="ttdoc">maximum length of a budget component names</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00036">Constants.f90:36</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a71c2790d83529c51a5fee3fe1d9bdd04_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a71c2790d83529c51a5fee3fe1d9bdd04_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a71c2790d83529c51a5fee3fe1d9bdd04_cgraph" id="anamespacegwfgwfexchangemodule_a71c2790d83529c51a5fee3fe1d9bdd04_cgraph">
<area shape="rect" title="@ brief Budget" alt="" coords="5,5,188,47"/>
<area shape="rect" href="namespacebudgetmodule.html#a917d4897942de165ea88d0c1f0850d8e" title="@ brief Rate accumulator subroutine" alt="" coords="236,5,387,47"/>
</map>
</div>

</div>
</div>
<a id="a60ec5bb56392096a9e44e295ab31c4cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ec5bb56392096a9e44e295ab31c4cf">&#9670;&nbsp;</a></span>gwf_gwf_bdsav()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_bdsav </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output individual flows to listing file and binary budget files </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00959">959</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: icbcfl, ibudfl</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">! -- budget for model1</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keyword">call </span>this%gwf_gwf_bdsav_model(this%gwfmodel1)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">! -- budget for model2</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keyword">call </span>this%gwf_gwf_bdsav_model(this%gwfmodel2)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">! -- Set icbcfl, ibudfl to zero so that flows will be printed and</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">!    saved, if the options were set in the MVR package</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    icbcfl = 1</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    ibudfl = 1</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">! -- Call mvr bd routine</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keyword">call </span>this%mvr%mvr_bdsav(icbcfl, ibudfl, 0)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="comment">! -- Calculate and write simulated values for observations</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keywordflow">if</span> (this%inobs /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keyword">call </span>this%gwf_gwf_save_simvals()</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd2e14cdc2fbc91cfdae11a6f4f61b09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd2e14cdc2fbc91cfdae11a6f4f61b09">&#9670;&nbsp;</a></span>gwf_gwf_bdsav_model()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_bdsav_model </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structgwfmodule_1_1gwfmodeltype.html">gwfmodeltype</a>), pointer&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>this exchange</td></tr>
    <tr><td class="paramname">model</td><td>the model to save budget for </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00993">993</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#adda4cd91b9096b31d5e48d2215359311">lenbudtxt</a>, <a class="code" href="namespaceconstantsmodule.html#a2e75f10abe62e57d87d7d468c2bf763d">lenpackagename</a></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt; this exchange</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordtype">type</span>(GwfModelType), <span class="keywordtype">pointer</span> :: model<span class="comment"> !&lt; the model to save budget for</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordtype">character(len=LENPACKAGENAME + 4)</span> :: packname</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordtype">character(len=LENBUDTXT)</span>, <span class="keywordtype">dimension(1)</span> :: budtxt</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordtype">type</span>(TableType), <span class="keywordtype">pointer</span> :: output_tab</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordtype">class</span>(VirtualModelType), <span class="keywordtype">pointer</span> :: nbr_model</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordtype">character(len=20)</span> :: nodestr</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bname</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ntabrows</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nodeu</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i, n1, n2, n1u, n2u</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibinun</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="keywordtype">    real</span>(DP) :: ratin, ratout, rrate</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: is_for_model1</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    budtxt(1) = <span class="stringliteral">&#39;    FLOW-JA-FACE&#39;</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    packname = <span class="stringliteral">&#39;EXG &#39;</span>//this%name</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    packname = adjustr(packname)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(model, this%gwfmodel1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      output_tab =&gt; this%outputtab1</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      nbr_model =&gt; this%v_model2</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      is_for_model1 = .true.</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      output_tab =&gt; this%outputtab2</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      nbr_model =&gt; this%v_model1</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      is_for_model1 = .false.</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">! -- update output tables</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">if</span> (this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="comment">! -- update titles</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">if</span> (model%oc%oc_save(<span class="stringliteral">&#39;BUDGET&#39;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keyword">call </span>output_tab%set_title(packname)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="comment">! -- set table kstp and kper</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="keyword">call </span>output_tab%set_kstpkper(<a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>)</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">! -- update maxbound of tables</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      ntabrows = 0</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">do</span> i = 1, this%nexg</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        n1 = this%nodem1(i)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        n2 = this%nodem2(i)</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="comment">! -- If both cells are active then calculate flow rate</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">if</span> (this%v_model1%ibound%get(n1) /= 0 .and. &amp;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            this%v_model2%ibound%get(n2) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;          ntabrows = ntabrows + 1</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keywordflow">if</span> (ntabrows &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keyword">call </span>output_tab%set_maxbound(ntabrows)</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">! -- Print and write budget terms</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="comment">! -- Set binary unit numbers for saving flows</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">if</span> (this%ipakcb /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      ibinun = model%oc%oc_save_unit(<span class="stringliteral">&#39;BUDGET&#39;</span>)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      ibinun = 0</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">! -- If save budget flag is zero for this stress period, then</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">!    shut off saving</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span> (.not. model%oc%oc_save(<span class="stringliteral">&#39;BUDGET&#39;</span>)) ibinun = 0</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">! -- If cell-by-cell flows will be saved as a list, write header.</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keyword">call </span>model%dis%record_srcdst_list_header(budtxt(1), &amp;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                               model%name, &amp;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                               this%name, &amp;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                               nbr_model%name, &amp;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                                               this%name, &amp;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                                               this%naux, this%auxname, &amp;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                               ibinun, this%nexg, &amp;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                               model%iout)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">! Initialize accumulators</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    ratin = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    ratout = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">! -- Loop through all exchanges</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nexg</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="comment">! -- Assign boundary name</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="keywordflow">if</span> (this%inamedbound &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        bname = this%boundname(i)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        bname = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="comment">! -- Calculate the flow rate between n1 and n2</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      rrate = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      n1 = this%nodem1(i)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      n2 = this%nodem2(i)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <span class="comment">! -- If both cells are active then calculate flow rate</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">if</span> (this%v_model1%ibound%get(n1) /= 0 .and. &amp;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;          this%v_model2%ibound%get(n2) /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        rrate = this%simvals(i)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="comment">! -- Print the individual rates to model list files if requested</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">if</span> (this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          <span class="keywordflow">if</span> (model%oc%oc_save(<span class="stringliteral">&#39;BUDGET&#39;</span>)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="comment">! -- set nodestr and write outputtab table</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="keywordflow">if</span> (is_for_model1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;              nodeu = model%dis%get_nodeuser(n1)</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;              <span class="keyword">call </span>model%dis%nodeu_to_string(nodeu, nodestr)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;              <span class="keyword">call </span>output_tab%print_list_entry(i, trim(adjustl(nodestr)), &amp;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                               rrate, bname)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;              nodeu = model%dis%get_nodeuser(n2)</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;              <span class="keyword">call </span>model%dis%nodeu_to_string(nodeu, nodestr)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;              <span class="keyword">call </span>output_tab%print_list_entry(i, trim(adjustl(nodestr)), &amp;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                                               -rrate, bname)</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">if</span> (rrate &lt; <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          ratout = ratout - rrate</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;          ratin = ratin + rrate</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="comment">! -- If saving cell-by-cell flows in list, write flow</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      n1u = this%v_model1%dis_get_nodeuser(n1)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      n2u = this%v_model2%dis_get_nodeuser(n2)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="keywordflow">if</span> (ibinun /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">if</span> (is_for_model1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;          <span class="keyword">call </span>model%dis%record_mf6_list_entry(ibinun, n1u, n2u, rrate, &amp;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                               this%naux, this%auxvar(:, i), &amp;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                               .false., .false.)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          <span class="keyword">call </span>model%dis%record_mf6_list_entry(ibinun, n2u, n1u, -rrate, &amp;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                               this%naux, this%auxvar(:, i), &amp;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                                               .false., .false.)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="ttc" id="anamespacetdismodule_html"><div class="ttname"><a href="namespacetdismodule.html">tdismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00005">tdis.f90:5</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ad3443c7d7da2a67a75174c39c6d40c84"><div class="ttname"><a href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">tdismodule::kstp</a></div><div class="ttdeci">integer(i4b), pointer, public kstp</div><div class="ttdoc">current time step number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00025">tdis.f90:25</a></div></div>
<div class="ttc" id="anamespacetdismodule_html_ae84d6ee69d7bba12d20a6255a398935b"><div class="ttname"><a href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">tdismodule::kper</a></div><div class="ttdeci">integer(i4b), pointer, public kper</div><div class="ttdoc">current stress period number</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00024">tdis.f90:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7d957087864e5e1d3c5e28a397450b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7d957087864e5e1d3c5e28a397450b7">&#9670;&nbsp;</a></span>gwf_gwf_calc_simvals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_calc_simvals </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00736">736</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n1, n2</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibdn1, ibdn2</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="keywordtype">    real</span>(DP) :: rrate</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nexg</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      rrate = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      n1 = this%nodem1(i)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      n2 = this%nodem2(i)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      ibdn1 = this%gwfmodel1%ibound(n1)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      ibdn2 = this%gwfmodel2%ibound(n2)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">if</span> (ibdn1 /= 0 .and. ibdn2 /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        rrate = this%qcalc(i, n1, n2)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          rrate = rrate + this%gnc%deltaqgnc(i)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      this%simvals(i) = rrate</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5c32a037157730a5e812541155e6149"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5c32a037157730a5e812541155e6149">&#9670;&nbsp;</a></span>gwf_gwf_cf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_cf </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Rewet as necessary </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00510">510</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">! -- Rewet cells across models using the wetdry parameters in each model&#39;s</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">!    npf package, and the head in the connected model.</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keyword">call </span>this%rewet(kiter)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa32abf1b9eb9d1a338b627696bddaefb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa32abf1b9eb9d1a338b627696bddaefb">&#9670;&nbsp;</a></span>gwf_gwf_connects_model()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical(lgp) function gwfgwfexchangemodule::gwf_gwf_connects_model </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structbasemodelmodule_1_1basemodeltype.html">basemodeltype</a>), intent(in), pointer&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">model</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwfExchangeType </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>the model to which the exchange might hold a connection </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true, when connected </dd></dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l02058">2058</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keywordtype">class</span>(BaseModelType), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span> :: model<span class="comment"> !&lt; the model to which the exchange might hold a connection</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: is_connected<span class="comment"> !&lt; true, when connected</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    is_connected = .false.</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="comment">! only connected when model is GwfModelType of course</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keywordflow">select type</span> (model)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="keywordflow">    class is</span> (gwfmodeltype)</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel1, model)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        is_connected = .true.</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel2, model)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        is_connected = .true.</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f4f7a596e1cf09b52235aa697a3278f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f4f7a596e1cf09b52235aa697a3278f">&#9670;&nbsp;</a></span>gwf_gwf_cq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_cq </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(inout)&#160;</td>
          <td class="paramname"><em>icnvg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isuppress_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>isolnid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate flow between two cells and store in simvals, also set information needed for specific discharge calculation </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00712">712</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(inout)</span> :: icnvg</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isuppress_output</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: isolnid</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">! -- calculate flow and store in simvals</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keyword">call </span>this%gwf_gwf_calc_simvals()</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">! -- set flows to model edges in NPF</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keyword">call </span>this%gwf_gwf_set_flow_to_npf()</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">! -- add exchange flows to model&#39;s flowja diagonal</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keyword">call </span>this%gwf_gwf_add_to_flowja()</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ed9e3680ace89214a3a9eb885dcf81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ed9e3680ace89214a3a9eb885dcf81b">&#9670;&nbsp;</a></span>gwf_gwf_da()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_da </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate memory associated with this object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01765">1765</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="comment">! -- objects</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keyword">call </span>this%gnc%gnc_da()</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <span class="keyword">deallocate</span> (this%gnc)</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keyword">call </span>this%mvr%mvr_da()</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      <span class="keyword">deallocate</span> (this%mvr)</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keyword">call </span>this%obs%obs_da()</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="keyword">deallocate</span> (this%obs)</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="comment">! -- arrays</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%cond)</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%condsat)</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idxglo)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idxsymglo)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%simvals)</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="comment">! -- output table objects</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%outputtab1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="keyword">call </span>this%outputtab1%table_da()</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <span class="keyword">deallocate</span> (this%outputtab1)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <span class="keyword">nullify</span> (this%outputtab1)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%outputtab2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keyword">call </span>this%outputtab2%table_da()</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <span class="keyword">deallocate</span> (this%outputtab2)</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="keyword">nullify</span> (this%outputtab2)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="comment">! -- scalars</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keyword">deallocate</span> (this%filename)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%iprflow)</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ipakcb)</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%icellavg)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ivarcv)</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%idewatcv)</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%inewton)</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%ingnc)</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%inmvr)</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%inobs)</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keyword">call </span><a class="code" href="interfacememorymanagermodule_1_1mem__deallocate.html">mem_deallocate</a>(this%satomega)</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">! -- deallocate base</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keyword">call </span>this%DisConnExchangeType%disconnex_da()</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="ainterfacememorymanagermodule_1_1mem__deallocate_html"><div class="ttname"><a href="interfacememorymanagermodule_1_1mem__deallocate.html">memorymanagermodule::mem_deallocate</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_manager_8f90_source.html#l00116">MemoryManager.f90:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8fd62a7c8068962d77882edcf4ff2216"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fd62a7c8068962d77882edcf4ff2216">&#9670;&nbsp;</a></span>gwf_gwf_df()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_df </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define GWF to GWF exchange object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00211">211</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimvariablesmodule.html">simvariablesmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>, <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceghostnodemodule.html">ghostnodemodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceghostnodemodule.html#a3f4539c3f97fd80471d86f2e9a347558">gnc_cr</a></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: inunit</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">! -- open the file</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    inunit = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">write</span> (<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, <span class="stringliteral">&#39;(/a,a)&#39;</span>) <span class="stringliteral">&#39; Creating exchange: &#39;</span>, this%name</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(inunit, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, this%filename, <span class="stringliteral">&#39;GWF-GWF&#39;</span>)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">call </span>this%parser%Initialize(inunit, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">! -- Ensure models are in same solution</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel1) .and. <span class="keyword">associated</span>(this%gwfmodel2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">if</span> (this%gwfmodel1%idsoln /= this%gwfmodel2%idsoln) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;ERROR.  TWO MODELS ARE CONNECTED IN A GWF &#39;</span>// &amp;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                         <span class="stringliteral">&#39;EXCHANGE BUT THEY ARE IN DIFFERENT SOLUTIONS. &#39;</span>// &amp;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                         <span class="stringliteral">&#39;GWF MODELS MUST BE IN SAME SOLUTION: &#39;</span>// &amp;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                         trim(this%gwfmodel1%name)//<span class="stringliteral">&#39; &#39;</span>// &amp;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                         trim(this%gwfmodel2%name))</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">! -- read options</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">call </span>this%read_options(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">! -- read dimensions</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keyword">call </span>this%read_dimensions(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">! -- allocate arrays</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keyword">call </span>this%allocate_arrays()</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">! -- read exchange data</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">call </span>this%read_data(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">! -- call each model and increase the edge count</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keyword">call </span>this%gwfmodel1%npf%increase_edge_count(this%nexg)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keyword">call </span>this%gwfmodel2%npf%increase_edge_count(this%nexg)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">! -- Create and read ghost node information</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceghostnodemodule.html#a3f4539c3f97fd80471d86f2e9a347558">gnc_cr</a>(this%gnc, this%name, this%ingnc, <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keyword">call </span>this%read_gnc()</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">! -- Read mover information</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keyword">call </span>this%read_mvr(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">! -- close the file</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keyword">close</span> (inunit)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">! -- Store obs</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keyword">call </span>this%gwf_gwf_df_obs()</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keyword">call </span>this%obs%obs_df(<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, this%name, <span class="stringliteral">&#39;GWF-GWF&#39;</span>, this%gwfmodel1%dis)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">! -- validate</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">call </span>this%validate_exchange()</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespaceghostnodemodule_html"><div class="ttname"><a href="namespaceghostnodemodule.html">ghostnodemodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_ghost_node_8f90_source.html#l00001">GhostNode.f90:1</a></div></div>
<div class="ttc" id="anamespaceghostnodemodule_html_a3f4539c3f97fd80471d86f2e9a347558"><div class="ttname"><a href="namespaceghostnodemodule.html#a3f4539c3f97fd80471d86f2e9a347558">ghostnodemodule::gnc_cr</a></div><div class="ttdeci">subroutine, public gnc_cr(gncobj, name_parent, inunit, iout)</div><div class="ttdef"><b>Definition:</b> <a href="_ghost_node_8f90_source.html#l00056">GhostNode.f90:57</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html"><div class="ttname"><a href="namespaceinputoutputmodule.html">inputoutputmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00003">InputOutput.f90:3</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a535bdfca3d31ebc3a8e4bd5af6890d55"><div class="ttname"><a href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">inputoutputmodule::getunit</a></div><div class="ttdeci">integer(i4b) function, public getunit()</div><div class="ttdoc">Get a free unit number.</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00188">InputOutput.f90:189</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_ae97851e3edae8d9809e384058a1a4d52"><div class="ttname"><a href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">inputoutputmodule::openfile</a></div><div class="ttdeci">subroutine, public openfile(iu, iout, fname, ftype, fmtarg_opt, accarg_opt, filstat_opt, mode_opt)</div><div class="ttdoc">Open a file.</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00036">InputOutput.f90:38</a></div></div>
<div class="ttc" id="anamespacesimvariablesmodule_html"><div class="ttname"><a href="namespacesimvariablesmodule.html">simvariablesmodule</a></div><div class="ttdoc">This module contains simulation variables.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00009">SimVariables.f90:9</a></div></div>
<div class="ttc" id="anamespacesimvariablesmodule_html_a70ea2f76b35a03119367efdd0dd88ccc"><div class="ttname"><a href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">simvariablesmodule::iout</a></div><div class="ttdeci">integer(i4b) iout</div><div class="ttdoc">file unit number for simulation output</div><div class="ttdef"><b>Definition:</b> <a href="_sim_variables_8f90_source.html#l00032">SimVariables.f90:32</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a8fd62a7c8068962d77882edcf4ff2216_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a8fd62a7c8068962d77882edcf4ff2216_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a8fd62a7c8068962d77882edcf4ff2216_cgraph" id="anamespacegwfgwfexchangemodule_a8fd62a7c8068962d77882edcf4ff2216_cgraph">
<area shape="rect" title="@ brief Define GWF GWF exchange" alt="" coords="5,93,188,135"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title="Get a free unit number." alt="" coords="253,5,408,47"/>
<area shape="rect" href="namespaceghostnodemodule.html#a3f4539c3f97fd80471d86f2e9a347558" title=" " alt="" coords="236,71,425,98"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title="Open a file." alt="" coords="253,123,408,164"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="473,189,648,215"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title="Assign a free unopened unit number." alt="" coords="483,32,638,73"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a8290bae8ca0756e38ce13459dfebe985" title="Convert to upper case." alt="" coords="483,123,638,164"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="696,189,835,215"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="883,148,1051,189"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="883,213,1051,255"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1099,126,1293,153"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1112,177,1280,219"/>
</map>
</div>

</div>
</div>
<a id="aa08b9ac097989c218665f87c84998a6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa08b9ac097989c218665f87c84998a6e">&#9670;&nbsp;</a></span>gwf_gwf_df_obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_df_obs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define the observations associated with this object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01904">1904</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: indx</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="comment">! -- Store obs type and assign procedure pointer</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="comment">!    for gwf-gwf observation type.</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keyword">call </span>this%obs%StoreObsType(<span class="stringliteral">&#39;flow-ja-face&#39;</span>, .true., indx)</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    this%obs%obsData(indx)%ProcessIdPtr =&gt; gwf_gwf_process_obsid</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_aa08b9ac097989c218665f87c84998a6e_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_aa08b9ac097989c218665f87c84998a6e_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_aa08b9ac097989c218665f87c84998a6e_cgraph" id="anamespacegwfgwfexchangemodule_aa08b9ac097989c218665f87c84998a6e_cgraph">
<area shape="rect" title="@ brief Define observations" alt="" coords="5,89,188,131"/>
<area shape="rect" href="namespacegwfgwfexchangemodule.html#a239e8be3dbc3db266c6a1ddac648bd5b" title="@ brief Obs ID processer" alt="" coords="236,89,420,131"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5" title="Extract a word from a string." alt="" coords="468,89,623,131"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a5d0681efcccbea67f1d521a6729cbb4f" title="Convert to lower case." alt="" coords="697,5,851,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1341,64,1509,105"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="687,122,861,149"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="671,173,877,199"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="925,151,1064,178"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1112,123,1280,164"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="1112,188,1280,229"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1328,130,1523,157"/>
</map>
</div>

</div>
</div>
<a id="a70c5db78158d40a4bb2de763715c5330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70c5db78158d40a4bb2de763715c5330">&#9670;&nbsp;</a></span>gwf_gwf_fc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_fc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmatrixbasemodule_1_1matrixbasetype.html">matrixbasetype</a>), pointer&#160;</td>
          <td class="paramname"><em>matrix_sln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs_sln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in), optional&#160;</td>
          <td class="paramname"><em>inwtflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate conductance and fill coefficient matrix </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00529">529</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a9262b16d485352c5d369c6cb86232c60">dhalf</a></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegwfnpfmodule.html">gwfnpfmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209">hcond</a>, <a class="code" href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e">vcond</a></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">class</span>(MatrixBaseType), <span class="keywordtype">pointer</span> :: matrix_sln</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="keywordtype">    real</span>(DP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: rhs_sln</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: inwtflag</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: inwt, iexg</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i, nodem1sln, nodem2sln</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">! -- calculate the conductance for each exchange connection</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">call </span>this%condcalc()</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">! -- if gnc is active, then copy cond into gnc cond (might consider a</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">!    pointer here in the future)</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">do</span> iexg = 1, this%nexg</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        this%gnc%cond(iexg) = this%cond(iexg)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">! -- Put this%cond into amatsln</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nexg</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keyword">call </span>matrix_sln%set_value_pos(this%idxglo(i), this%cond(i))</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keyword">call </span>matrix_sln%set_value_pos(this%idxsymglo(i), this%cond(i))</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      nodem1sln = this%nodem1(i) + this%gwfmodel1%moffset</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      nodem2sln = this%nodem2(i) + this%gwfmodel2%moffset</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keyword">call </span>matrix_sln%add_diag_value(nodem1sln, -this%cond(i))</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keyword">call </span>matrix_sln%add_diag_value(nodem2sln, -this%cond(i))</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">! -- Fill the gnc terms in the solution matrix</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keyword">call </span>this%gnc%gnc_fc(kiter, matrix_sln)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">! -- Call mvr fc routine</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keyword">call </span>this%mvr%mvr_fc()</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">! -- Set inwt to exchange newton, but shut off if requested by caller</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    inwt = this%inewton</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(inwtflag)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordflow">if</span> (inwtflag == 0) inwt = 0</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (inwt /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keyword">call </span>this%exg_fn(kiter, matrix_sln)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">! -- Ghost node Newton-Raphson</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">if</span> (inwt /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keyword">call </span>this%gnc%gnc_fn(kiter, matrix_sln, this%condsat, &amp;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                             ihc_opt=this%ihc, ivarcv_opt=this%ivarcv, &amp;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                             ictm1_opt=this%gwfmodel1%npf%icelltype, &amp;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                             ictm2_opt=this%gwfmodel2%npf%icelltype)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a70c5db78158d40a4bb2de763715c5330_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a70c5db78158d40a4bb2de763715c5330_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a70c5db78158d40a4bb2de763715c5330_cgraph" id="anamespacegwfgwfexchangemodule_a70c5db78158d40a4bb2de763715c5330_cgraph">
<area shape="rect" title="@ brief Fill coefficients" alt="" coords="5,49,188,90"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a7fc55c137cbf452e811e7bda474af209" title=" " alt="" coords="236,31,399,57"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a0ac64188c68a16279d975e588393259e" title=" " alt="" coords="236,81,399,108"/>
<area shape="rect" href="namespacegwfnpfmodule.html#ae3238216f84434bb2862e840a6ebeb00" title=" " alt="" coords="492,5,684,32"/>
<area shape="rect" href="namespacesmoothingmodule.html#a4be083cd9964c682d55802ff9bc436bc" title=" " alt="" coords="447,56,729,83"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a905d9a528c4d4a783096b639298d42b3" title=" " alt="" coords="777,5,959,32"/>
</map>
</div>

</div>
</div>
<a id="a6c44a3ed85d7ffa16d5bda5e6062d990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c44a3ed85d7ffa16d5bda5e6062d990">&#9670;&nbsp;</a></span>gwf_gwf_fn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_fn </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmatrixbasemodule_1_1matrixbasetype.html">matrixbasetype</a>), pointer&#160;</td>
          <td class="paramname"><em>matrix_sln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fill amatsln with Newton terms </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00601">601</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesmoothingmodule.html">smoothingmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c">squadraticsaturationderivative</a></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordtype">class</span>(MatrixBaseType), <span class="keywordtype">pointer</span> :: matrix_sln</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">logical</span> :: nisup</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iexg</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, m</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: nodensln, nodemsln</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibdn, ibdm</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="keywordtype">    real</span>(DP) :: topn, topm</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordtype">    real</span>(DP) :: botn, botm</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordtype">    real</span>(DP) :: topup, botup</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordtype">    real</span>(DP) :: hn, hm</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keywordtype">    real</span>(DP) :: hup, hdn</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordtype">    real</span>(DP) :: cond</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keywordtype">    real</span>(DP) :: term</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keywordtype">    real</span>(DP) :: consterm</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordtype">    real</span>(DP) :: derv</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">do</span> iexg = 1, this%nexg</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      n = this%nodem1(iexg)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      m = this%nodem2(iexg)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      nodensln = this%nodem1(iexg) + this%gwfmodel1%moffset</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      nodemsln = this%nodem2(iexg) + this%gwfmodel2%moffset</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      ibdn = this%gwfmodel1%ibound(n)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      ibdm = this%gwfmodel2%ibound(m)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      topn = this%gwfmodel1%dis%top(n)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      topm = this%gwfmodel2%dis%top(m)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      botn = this%gwfmodel1%dis%bot(n)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      botm = this%gwfmodel2%dis%bot(m)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      hn = this%gwfmodel1%x(n)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      hm = this%gwfmodel2%x(m)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">if</span> (this%ihc(iexg) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment">! -- vertical connection, newton not supported</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="comment">! -- determine upstream node</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        nisup = .false.</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">if</span> (hm &lt; hn) nisup = .true.</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="comment">! -- set upstream top and bot</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">if</span> (nisup) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          topup = topn</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;          botup = botn</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          hup = hn</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          hdn = hm</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          topup = topm</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          botup = botm</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          hup = hm</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          hdn = hn</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="comment">! -- no newton terms if upstream cell is confined</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">if</span> (nisup) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          <span class="keywordflow">if</span> (this%gwfmodel1%npf%icelltype(n) == 0) cycle</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          <span class="keywordflow">if</span> (this%gwfmodel2%npf%icelltype(m) == 0) cycle</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="comment">! -- set topup and botup</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">if</span> (this%ihc(iexg) == 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          topup = min(topn, topm)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;          botup = max(botn, botm)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="comment">! get saturated conductivity for derivative</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        cond = this%condsat(iexg)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">! -- TO DO deal with MODFLOW-NWT upstream weighting option</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="comment">! -- compute terms</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        consterm = -cond * (hup - hdn)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        derv = <a class="code" href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c">squadraticsaturationderivative</a>(topup, botup, hup)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">if</span> (nisup) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="comment">! -- fill jacobian with n being upstream</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          term = consterm * derv</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          this%gwfmodel1%rhs(n) = this%gwfmodel1%rhs(n) + term * hn</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          this%gwfmodel2%rhs(m) = this%gwfmodel2%rhs(m) - term * hn</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          <span class="keyword">call </span>matrix_sln%add_diag_value(nodensln, term)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          <span class="keywordflow">if</span> (ibdm &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keyword">call </span>matrix_sln%add_value_pos(this%idxsymglo(iexg), -term)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          <span class="comment">! -- fill jacobian with m being upstream</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          term = -consterm * derv</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          this%gwfmodel1%rhs(n) = this%gwfmodel1%rhs(n) + term * hm</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          this%gwfmodel2%rhs(m) = this%gwfmodel2%rhs(m) - term * hm</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          <span class="keyword">call </span>matrix_sln%add_diag_value(nodemsln, -term)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          <span class="keywordflow">if</span> (ibdn &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keyword">call </span>matrix_sln%add_value_pos(this%idxglo(iexg), term)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacesmoothingmodule_html"><div class="ttname"><a href="namespacesmoothingmodule.html">smoothingmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_smoothing_functions_8f90_source.html#l00001">SmoothingFunctions.f90:1</a></div></div>
<div class="ttc" id="anamespacesmoothingmodule_html_a0ee42e035a1831565d3132d8929eb67c"><div class="ttname"><a href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c">smoothingmodule::squadraticsaturationderivative</a></div><div class="ttdeci">real(dp) function squadraticsaturationderivative(top, bot, x, eps, bmin)</div><div class="ttdef"><b>Definition:</b> <a href="_smoothing_functions_8f90_source.html#l00414">SmoothingFunctions.f90:415</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a6c44a3ed85d7ffa16d5bda5e6062d990_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a6c44a3ed85d7ffa16d5bda5e6062d990_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a6c44a3ed85d7ffa16d5bda5e6062d990_cgraph" id="anamespacegwfgwfexchangemodule_a6c44a3ed85d7ffa16d5bda5e6062d990_cgraph">
<area shape="rect" title="@ brief Fill Newton" alt="" coords="5,5,188,47"/>
<area shape="rect" href="namespacesmoothingmodule.html#a0ee42e035a1831565d3132d8929eb67c" title=" " alt="" coords="236,13,584,39"/>
</map>
</div>

</div>
</div>
<a id="a152f734583a3af9255fd29d4ccde2eee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a152f734583a3af9255fd29d4ccde2eee">&#9670;&nbsp;</a></span>gwf_gwf_fp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_fp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Conduct any final processing </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01999">1999</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0de8a3892605167994d5df3995c0d6a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0de8a3892605167994d5df3995c0d6a3">&#9670;&nbsp;</a></span>gwf_gwf_get_iasym()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(i4b) function gwfgwfexchangemodule::gwf_gwf_get_iasym </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return flag indicating whether or not this exchange will cause the coefficient matrix to be asymmetric. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l02034">2034</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iasym</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="comment">! -- Start by setting iasym to zero</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    iasym = 0</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">! -- Groundwater flow</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">if</span> (this%inewton /= 0) iasym = 1</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="comment">! -- GNC</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <span class="keywordflow">if</span> (this%gnc%iasym /= 0) iasym = 1</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac02c06bb72ba58f133176a3bd49118f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac02c06bb72ba58f133176a3bd49118f3">&#9670;&nbsp;</a></span>gwf_gwf_mc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_mc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structmatrixbasemodule_1_1matrixbasetype.html">matrixbasetype</a>), pointer&#160;</td>
          <td class="paramname"><em>matrix_sln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Map the connections in the global matrix </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
    <tr><td class="paramname">matrix_sln</td><td>the system matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00411">411</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesparsemodule.html">sparsemodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structsparsemodule_1_1sparsematrix.html">sparsematrix</a></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">class</span>(MatrixBaseType), <span class="keywordtype">pointer</span> :: matrix_sln<span class="comment"> !&lt; the system matrix</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, iglo, jglo</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">! -- map exchange connections</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">do</span> n = 1, this%nexg</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      iglo = this%nodem1(n) + this%gwfmodel1%moffset</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      jglo = this%nodem2(n) + this%gwfmodel2%moffset</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      this%idxglo(n) = matrix_sln%get_position(iglo, jglo)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      this%idxsymglo(n) = matrix_sln%get_position(jglo, iglo)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">! -- map gnc connections</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keyword">call </span>this%gnc%gnc_mc(matrix_sln)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5ade52e6073f558a747ab8802b1a694"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5ade52e6073f558a747ab8802b1a694">&#9670;&nbsp;</a></span>gwf_gwf_ot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_ot </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write output </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01152">1152</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimvariablesmodule.html">simvariablesmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iexg, n1, n2</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibudfl</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="keywordtype">    real</span>(DP) :: flow, deltaqgnc</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: node1str, node2str</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">! -- format</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtheader = &amp;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;     <span class="stringliteral">&quot;(/1x, &#39;SUMMARY OF EXCHANGE RATES FOR EXCHANGE &#39;, a, &#39; WITH ID &#39;, i0, /, &amp;</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="stringliteral"></span><span class="stringliteral">       &amp;2a16, 5a16, /, 112(&#39;-&#39;))&quot;</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtheader2 = &amp;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;     <span class="stringliteral">&quot;(/1x, &#39;SUMMARY OF EXCHANGE RATES FOR EXCHANGE &#39;, a, &#39; WITH ID &#39;, i0, /, &amp;</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="stringliteral"></span><span class="stringliteral">       &amp;2a16, 4a16, /, 96(&#39;-&#39;))&quot;</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtdata = &amp;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                   <span class="stringliteral">&quot;(2a16, 5(1pg16.6))&quot;</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">! -- Call bdsave</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keyword">call </span>this%gwf_gwf_bdsav()</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">! -- Initialize</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    deltaqgnc = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">! -- Write a table of exchanges</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">if</span> (this%iprflow /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keyword">write</span> (<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, fmtheader) trim(adjustl(this%name)), this%id, <span class="stringliteral">&#39;NODEM1&#39;</span>, &amp;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          <span class="stringliteral">&#39;NODEM2&#39;</span>, <span class="stringliteral">&#39;COND&#39;</span>, <span class="stringliteral">&#39;X_M1&#39;</span>, <span class="stringliteral">&#39;X_M2&#39;</span>, <span class="stringliteral">&#39;DELTAQGNC&#39;</span>, &amp;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          <span class="stringliteral">&#39;FLOW&#39;</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keyword">write</span> (<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, fmtheader2) trim(adjustl(this%name)), this%id, <span class="stringliteral">&#39;NODEM1&#39;</span>, &amp;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;          <span class="stringliteral">&#39;NODEM2&#39;</span>, <span class="stringliteral">&#39;COND&#39;</span>, <span class="stringliteral">&#39;X_M1&#39;</span>, <span class="stringliteral">&#39;X_M2&#39;</span>, <span class="stringliteral">&#39;FLOW&#39;</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordflow">do</span> iexg = 1, this%nexg</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        n1 = this%nodem1(iexg)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        n2 = this%nodem2(iexg)</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        flow = this%simvals(iexg)</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="keyword">call </span>this%v_model1%dis_noder_to_string(n1, node1str)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="keyword">call </span>this%v_model2%dis_noder_to_string(n2, node2str)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">if</span> (this%ingnc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;          deltaqgnc = this%gnc%deltaqgnc(iexg)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          <span class="keyword">write</span> (<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, fmtdata) trim(adjustl(node1str)), &amp;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            trim(adjustl(node2str)), &amp;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            this%cond(iexg), this%v_model1%x%get(n1), &amp;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            this%v_model2%x%get(n2), deltaqgnc, flow</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;          <span class="keyword">write</span> (<a class="code" href="namespacesimvariablesmodule.html#a70ea2f76b35a03119367efdd0dd88ccc">iout</a>, fmtdata) trim(adjustl(node1str)), &amp;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            trim(adjustl(node2str)), &amp;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            this%cond(iexg), this%v_model1%x%get(n1), &amp;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            this%v_model2%x%get(n2), flow</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">! -- Mover budget output</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    ibudfl = 1</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keyword">call </span>this%mvr%mvr_ot_bdsummary(ibudfl)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">! -- OBS output</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keyword">call </span>this%obs%obs_ot()</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a239e8be3dbc3db266c6a1ddac648bd5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a239e8be3dbc3db266c6a1ddac648bd5b">&#9670;&nbsp;</a></span>gwf_gwf_process_obsid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_process_obsid </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structobservemodule_1_1observetype.html">observetype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>obsrv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structbasedismodule_1_1disbasetype.html">disbasetype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>dis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>inunitobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Process observations for this exchange </p>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l02140">2140</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5">urword</a></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceobservemodule.html">observemodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structobservemodule_1_1observetype.html">observetype</a></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebasedismodule.html">basedismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbasedismodule_1_1disbasetype.html">disbasetype</a></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="keywordtype">type</span>(ObserveType), <span class="keywordtype">intent(inout)</span> :: obsrv</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordtype">class</span>(DisBaseType), <span class="keywordtype">intent(in)</span> :: dis</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: inunitobs</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, iexg, istat</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: icol, istart, istop</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="keywordtype">    real</span>(DP) :: r</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: strng</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    strng = obsrv%IDstring</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    icol = 1</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="comment">! -- get exchange index</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5">urword</a>(strng, icol, istart, istop, 1, n, r, iout, inunitobs)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keyword">read</span> (strng(istart:istop), <span class="stringliteral">&#39;(i10)&#39;</span>, iostat=istat) iexg</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">if</span> (istat == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      obsrv%intPak1 = iexg</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <span class="comment">! Integer can&#39;t be read from strng; it&#39;s presumed to be an exchange</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="comment">! boundary name (already converted to uppercase)</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      obsrv%FeatureName = trim(adjustl(strng))</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="comment">! -- Observation may require summing rates from multiple exchange</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="comment">!    boundaries, so assign intPak1 as a value that indicates observation</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="comment">!    is for a named exchange boundary or group of exchange boundaries.</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      obsrv%intPak1 = namedboundflag</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacebasedismodule_html"><div class="ttname"><a href="namespacebasedismodule.html">basedismodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_discretization_base_8f90_source.html#l00001">DiscretizationBase.f90:1</a></div></div>
<div class="ttc" id="anamespaceinputoutputmodule_html_a653efe7e8a111c5e477fea26e0b04fe5"><div class="ttname"><a href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5">inputoutputmodule::urword</a></div><div class="ttdeci">subroutine, public urword(LINE, ICOL, ISTART, ISTOP, NCODE, N, R, IOUT, IN)</div><div class="ttdoc">Extract a word from a string.</div><div class="ttdef"><b>Definition:</b> <a href="_input_output_8f90_source.html#l00762">InputOutput.f90:763</a></div></div>
<div class="ttc" id="anamespaceobservemodule_html"><div class="ttname"><a href="namespaceobservemodule.html">observemodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_observe_8f90_source.html#l00012">Observe.f90:12</a></div></div>
<div class="ttc" id="astructbasedismodule_1_1disbasetype_html"><div class="ttname"><a href="structbasedismodule_1_1disbasetype.html">basedismodule::disbasetype</a></div><div class="ttdef"><b>Definition:</b> <a href="_discretization_base_8f90_source.html#l00025">DiscretizationBase.f90:25</a></div></div>
<div class="ttc" id="astructobservemodule_1_1observetype_html"><div class="ttname"><a href="structobservemodule_1_1observetype.html">observemodule::observetype</a></div><div class="ttdef"><b>Definition:</b> <a href="_observe_8f90_source.html#l00032">Observe.f90:32</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a239e8be3dbc3db266c6a1ddac648bd5b_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a239e8be3dbc3db266c6a1ddac648bd5b_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a239e8be3dbc3db266c6a1ddac648bd5b_cgraph" id="anamespacegwfgwfexchangemodule_a239e8be3dbc3db266c6a1ddac648bd5b_cgraph">
<area shape="rect" title="@ brief Obs ID processer" alt="" coords="5,89,189,131"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a653efe7e8a111c5e477fea26e0b04fe5" title="Extract a word from a string." alt="" coords="237,89,392,131"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a5d0681efcccbea67f1d521a6729cbb4f" title="Convert to lower case." alt="" coords="466,5,621,47"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1111,64,1279,105"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="456,122,631,149"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="440,173,647,199"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="695,151,833,178"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="881,123,1049,164"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="881,188,1049,229"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1097,130,1292,157"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a239e8be3dbc3db266c6a1ddac648bd5b_icgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a239e8be3dbc3db266c6a1ddac648bd5b_icgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a239e8be3dbc3db266c6a1ddac648bd5b_icgraph" id="anamespacegwfgwfexchangemodule_a239e8be3dbc3db266c6a1ddac648bd5b_icgraph">
<area shape="rect" title="@ brief Obs ID processer" alt="" coords="236,5,420,47"/>
<area shape="rect" href="namespacegwfgwfexchangemodule.html#aa08b9ac097989c218665f87c84998a6e" title="@ brief Define observations" alt="" coords="5,5,188,47"/>
</map>
</div>

</div>
</div>
<a id="a8ab6d07c651d179d57c04fa2e7db090d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ab6d07c651d179d57c04fa2e7db090d">&#9670;&nbsp;</a></span>gwf_gwf_rp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_rp </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read new data for mover and obs </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00465">465</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#a894366d099576e075e2cd7cb3fa37dba">readnewdata</a></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">! -- Check with TDIS on whether or not it is time to RP</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">if</span> (.not. <a class="code" href="namespacetdismodule.html#a894366d099576e075e2cd7cb3fa37dba">readnewdata</a>) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">! -- Read and prepare for mover</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">if</span> (this%inmvr &gt; 0) <span class="keyword">call </span>this%mvr%mvr_rp()</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">! -- Read and prepare for observations</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keyword">call </span>this%gwf_gwf_rp_obs()</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacetdismodule_html_a894366d099576e075e2cd7cb3fa37dba"><div class="ttname"><a href="namespacetdismodule.html#a894366d099576e075e2cd7cb3fa37dba">tdismodule::readnewdata</a></div><div class="ttdeci">logical(lgp), pointer, public readnewdata</div><div class="ttdoc">flag indicating time to read new data</div><div class="ttdef"><b>Definition:</b> <a href="tdis_8f90_source.html#l00027">tdis.f90:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8642d52730bcecfc8d9c00926d5a8d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8642d52730bcecfc8d9c00926d5a8d4">&#9670;&nbsp;</a></span>gwf_gwf_rp_obs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_rp_obs </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handle observation exchanges exchange-boundary names. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01924">1924</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keywordtype">class</span>(ObserveType), <span class="keywordtype">pointer</span> :: obsrv =&gt; null()</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordtype">character(len=LENBOUNDNAME)</span> :: bname</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordtype">logical</span> :: jfound</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">! -- formats</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;10  <span class="keyword">format</span>(<span class="stringliteral">&#39;Exchange &quot;&#39;</span>, a, <span class="stringliteral">&#39;&quot; for observation &quot;&#39;</span>, a, &amp;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;           <span class="stringliteral">&#39;&quot; is invalid in package &quot;&#39;</span>, a, <span class="stringliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;20  <span class="keyword">format</span>(<span class="stringliteral">&#39;Exchange id &quot;&#39;</span>, i0, <span class="stringliteral">&#39;&quot; for observation &quot;&#39;</span>, a, &amp;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;           <span class="stringliteral">&#39;&quot; is invalid in package &quot;&#39;</span>, a, <span class="stringliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">do</span> i = 1, this%obs%npakobs</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      obsrv =&gt; this%obs%pakobs(i)%obsrv</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="comment">! -- indxbnds needs to be reset each stress period because</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <span class="comment">!    list of boundaries can change each stress period.</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="comment">! -- Not true for exchanges, but leave this in for now anyway.</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keyword">call </span>obsrv%ResetObsIndex()</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      obsrv%BndFound = .false.</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      bname = obsrv%FeatureName</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keywordflow">if</span> (bname /= <span class="stringliteral">&#39;&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="comment">! -- Observation location(s) is(are) based on a boundary name.</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <span class="comment">!    Iterate through all boundaries to identify and store</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="comment">!    corresponding index(indices) in bound array.</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        jfound = .false.</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="keywordflow">do</span> j = 1, this%nexg</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;          <span class="keywordflow">if</span> (this%boundname(j) == bname) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            jfound = .true.</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            obsrv%BndFound = .true.</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            obsrv%CurrentTimeStepEndValue = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <span class="keyword">call </span>obsrv%AddObsIndex(j)</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        <span class="keywordflow">if</span> (.not. jfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;          <span class="keyword">write</span> (errmsg, 10) trim(bname), trim(obsrv%ObsTypeId), trim(this%name)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="comment">! -- Observation location is a single exchange number</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="keywordflow">if</span> (obsrv%intPak1 &lt;= this%nexg .and. obsrv%intPak1 &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;          jfound = .true.</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;          obsrv%BndFound = .true.</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;          obsrv%CurrentTimeStepEndValue = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;          <span class="keyword">call </span>obsrv%AddObsIndex(obsrv%intPak1)</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;          jfound = .false.</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordflow">if</span> (.not. jfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;          <span class="keyword">write</span> (errmsg, 20) obsrv%intPak1, trim(obsrv%ObsTypeId), trim(this%name)</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;          <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="comment">! -- write summary of error messages</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">if</span> (count_errors() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <span class="keyword">call </span>store_error_unit(this%inobs)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_ab8642d52730bcecfc8d9c00926d5a8d4_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_ab8642d52730bcecfc8d9c00926d5a8d4_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_ab8642d52730bcecfc8d9c00926d5a8d4_cgraph" id="anamespacegwfgwfexchangemodule_ab8642d52730bcecfc8d9c00926d5a8d4_cgraph">
<area shape="rect" title="@ brief Read and prepare observations" alt="" coords="5,49,188,90"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="247,5,431,32"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="252,56,427,83"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="236,107,443,133"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="491,81,629,108"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="677,41,845,82"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="677,106,845,147"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="893,19,1088,45"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="907,70,1075,111"/>
</map>
</div>

</div>
</div>
<a id="a4d20dd3801d4fc9fe96c67b0ed02448b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d20dd3801d4fc9fe96c67b0ed02448b">&#9670;&nbsp;</a></span>gwf_gwf_save_simvals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_save_simvals </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Save the simulated flows for each exchange </p>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l02092">2092</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>, <a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceobservemodule.html">observemodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structobservemodule_1_1observetype.html">observetype</a></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: j</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n1</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n2</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iexg</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="keywordtype">    real</span>(DP) :: v</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordtype">character(len=100)</span> :: msg</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordtype">type</span>(ObserveType), <span class="keywordtype">pointer</span> :: obsrv =&gt; null()</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="comment">! -- Write simulated values for all gwf-gwf observations</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="keywordflow">if</span> (this%obs%npakobs &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      <span class="keyword">call </span>this%obs%obs_bd_clear()</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      <span class="keywordflow">do</span> i = 1, this%obs%npakobs</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        obsrv =&gt; this%obs%pakobs(i)%obsrv</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="keywordflow">do</span> j = 1, obsrv%indxbnds_count</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;          iexg = obsrv%indxbnds(j)</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;          v = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;          <span class="keywordflow">select case</span> (obsrv%ObsTypeId)</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;          <span class="keywordflow">case</span> (<span class="stringliteral">&#39;FLOW-JA-FACE&#39;</span>)</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            n1 = this%nodem1(iexg)</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            n2 = this%nodem2(iexg)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            v = this%simvals(iexg)</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="keywordflow">          case default</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            msg = <span class="stringliteral">&#39;Error: Unrecognized observation type: &#39;</span>// &amp;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                  trim(obsrv%ObsTypeId)</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(msg)</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>(this%inobs)</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="keywordflow">          end select</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;          <span class="keyword">call </span>this%obs%SaveOneSimval(obsrv, v)</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacesimmodule_html"><div class="ttname"><a href="namespacesimmodule.html">simmodule</a></div><div class="ttdoc">This module contains simulation methods.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00010">Sim.f90:10</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a21870712a1166225fdcd5b60bffb353e"><div class="ttname"><a href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">simmodule::store_error</a></div><div class="ttdeci">subroutine, public store_error(msg, terminate)</div><div class="ttdoc">Store error message.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00128">Sim.f90:129</a></div></div>
<div class="ttc" id="anamespacesimmodule_html_a83910ed20af1fec9bdf46cad8c276538"><div class="ttname"><a href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">simmodule::store_error_unit</a></div><div class="ttdeci">subroutine, public store_error_unit(iunit, terminate)</div><div class="ttdoc">Store the file unit number.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00208">Sim.f90:209</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a4d20dd3801d4fc9fe96c67b0ed02448b_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a4d20dd3801d4fc9fe96c67b0ed02448b_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a4d20dd3801d4fc9fe96c67b0ed02448b_cgraph" id="anamespacegwfgwfexchangemodule_a4d20dd3801d4fc9fe96c67b0ed02448b_cgraph">
<area shape="rect" title="@ brief Save simulated flow observations" alt="" coords="5,61,188,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="252,43,427,69"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="236,93,443,120"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="491,68,629,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="677,27,845,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="677,93,845,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="893,5,1088,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="907,57,1075,98"/>
</map>
</div>

</div>
</div>
<a id="aa45d4bd831f936651854f0eb66e860f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa45d4bd831f936651854f0eb66e860f6">&#9670;&nbsp;</a></span>gwf_gwf_set_flow_to_npf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::gwf_gwf_set_flow_to_npf </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00796">796</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a>, <a class="code" href="namespaceconstantsmodule.html#aa782c151085f5c3c4892ecb72cdda2ce">dpio180</a></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegwfnpfmodule.html">gwfnpfmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacegwfnpfmodule.html#a043778a29f31835c4167e493e79df0ef">thksatnm</a></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iusg</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n1, n2</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibdn1, ibdn2</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ictn1, ictn2</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ihc</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="keywordtype">    real</span>(DP) :: rrate</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="keywordtype">    real</span>(DP) :: topn1, topn2</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="keywordtype">    real</span>(DP) :: botn1, botn2</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="keywordtype">    real</span>(DP) :: satn1, satn2</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="keywordtype">    real</span>(DP) :: hn1, hn2</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keywordtype">    real</span>(DP) :: nx, ny</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="keywordtype">    real</span>(DP) :: distance</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="keywordtype">    real</span>(DP) :: dltot</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="keywordtype">    real</span>(DP) :: hwva</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="keywordtype">    real</span>(DP) :: area</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keywordtype">    real</span>(DP) :: thksat</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="keywordtype">    real</span>(DP) :: angle</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">! -- Return if there neither model needs to calculate specific discharge</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (this%gwfmodel1%npf%icalcspdis == 0 .and. &amp;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        this%gwfmodel2%npf%icalcspdis == 0) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment">! -- initialize</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    iusg = 0</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">! -- Loop through all exchanges using the flow rate</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="comment">!    stored in simvals</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nexg</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      rrate = this%simvals(i)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      n1 = this%nodem1(i)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      n2 = this%nodem2(i)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      ihc = this%ihc(i)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      hwva = this%hwva(i)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      ibdn1 = this%gwfmodel1%ibound(n1)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      ibdn2 = this%gwfmodel2%ibound(n2)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      ictn1 = this%gwfmodel1%npf%icelltype(n1)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      ictn2 = this%gwfmodel2%npf%icelltype(n2)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      topn1 = this%gwfmodel1%dis%top(n1)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      topn2 = this%gwfmodel2%dis%top(n2)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      botn1 = this%gwfmodel1%dis%bot(n1)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      botn2 = this%gwfmodel2%dis%bot(n2)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      satn1 = this%gwfmodel1%npf%sat(n1)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      satn2 = this%gwfmodel2%npf%sat(n2)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      hn1 = this%gwfmodel1%x(n1)</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      hn2 = this%gwfmodel2%x(n2)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="comment">! -- Calculate face normal components</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">if</span> (ihc == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        nx = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        ny = <a class="code" href="namespaceconstantsmodule.html#abab5757666b9ddd2726c20ce48dd0050">dzero</a></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        area = hwva</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">if</span> (botn1 &lt; botn2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;          <span class="comment">! -- n1 is beneath n2, so rate is positive downward.  Flip rate</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;          <span class="comment">!    upward so that points in positive z direction</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;          rrate = -rrate</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (this%ianglex &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;          angle = this%auxvar(this%ianglex, i) * <a class="code" href="namespaceconstantsmodule.html#aa782c151085f5c3c4892ecb72cdda2ce">dpio180</a></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          nx = cos(angle)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          ny = sin(angle)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <span class="comment">! error?</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;error in gwf_gwf_cq&#39;</span>, terminate=.true.)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="comment">! -- Calculate the saturated thickness at interface between n1 and n2</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        thksat = <a class="code" href="namespacegwfnpfmodule.html#a043778a29f31835c4167e493e79df0ef">thksatnm</a>(ibdn1, ibdn2, ictn1, ictn2, this%inewton, ihc, &amp;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                          iusg, hn1, hn2, satn1, satn2, &amp;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                          topn1, topn2, botn1, botn2, this%satomega)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        area = hwva * thksat</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="comment">! -- Submit this connection and flow information to the npf</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="comment">!    package of gwfmodel1</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">if</span> (this%icdist &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        dltot = this%auxvar(this%icdist, i)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;error in gwf_gwf_cq&#39;</span>, terminate=.true.)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      distance = dltot * this%cl1(i) / (this%cl1(i) + this%cl2(i))</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keywordflow">if</span> (this%gwfmodel1%npf%icalcspdis == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keyword">call </span>this%gwfmodel1%npf%set_edge_properties(n1, ihc, rrate, area, &amp;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                                    nx, ny, distance)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="comment">! -- Submit this connection and flow information to the npf</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="comment">!    package of gwfmodel2</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="keywordflow">if</span> (this%icdist &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        dltot = this%auxvar(this%icdist, i)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;error in gwf_gwf_cq&#39;</span>, terminate=.true.)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">if</span> (this%gwfmodel2%npf%icalcspdis == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        distance = dltot * this%cl2(i) / (this%cl1(i) + this%cl2(i))</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">if</span> (ihc /= 0) rrate = -rrate</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keyword">call </span>this%gwfmodel2%npf%set_edge_properties(n2, ihc, rrate, area, &amp;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                                                    -nx, -ny, distance)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacegwfnpfmodule_html_a043778a29f31835c4167e493e79df0ef"><div class="ttname"><a href="namespacegwfnpfmodule.html#a043778a29f31835c4167e493e79df0ef">gwfnpfmodule::thksatnm</a></div><div class="ttdeci">real(dp) function, public thksatnm(ibdn, ibdm, ictn, ictm, inwtup, ihc, iusg, hn, hm, satn, satm, topn, topm, botn, botm, satomega, satminopt)</div><div class="ttdef"><b>Definition:</b> <a href="gwf3npf8_8f90_source.html#l03593">gwf3npf8.f90:3596</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_aa45d4bd831f936651854f0eb66e860f6_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_aa45d4bd831f936651854f0eb66e860f6_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_aa45d4bd831f936651854f0eb66e860f6_cgraph" id="anamespacegwfgwfexchangemodule_aa45d4bd831f936651854f0eb66e860f6_cgraph">
<area shape="rect" title="Set flow rates to the edges in the models." alt="" coords="5,86,200,127"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="254,68,429,95"/>
<area shape="rect" href="namespacegwfnpfmodule.html#a043778a29f31835c4167e493e79df0ef" title=" " alt="" coords="248,119,435,145"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="555,68,693,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="813,27,981,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="813,93,981,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1029,5,1224,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1043,57,1211,98"/>
<area shape="rect" href="namespacesmoothingmodule.html#a4be083cd9964c682d55802ff9bc436bc" title=" " alt="" coords="483,119,765,145"/>
</map>
</div>

</div>
</div>
<a id="a8e8db965870b9878ff9fb5476227b92d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e8db965870b9878ff9fb5476227b92d">&#9670;&nbsp;</a></span>gwfexchange_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public gwfgwfexchangemodule::gwfexchange_create </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*)&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>m1_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>m2_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>filename for reading </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">name</td><td>exchange name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>id for the exchange </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m1_id</td><td>id for model 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m2_id</td><td>id for model 2 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00123">123</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacebasemodelmodule.html">basemodelmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="structbasemodelmodule_1_1basemodeltype.html">basemodeltype</a></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacevirtualmodelmodule.html">virtualmodelmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacevirtualmodelmodule.html#abba1d301227ee5a4b869b54fc98e6e59">get_virtual_model</a></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacelistsmodule.html">listsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacelistsmodule.html#a3e857b53bd777fd84ebcc75f2d7fe273">baseexchangelist</a></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceobsmodule.html">obsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceobsmodule.html#a57372fbf202fe90e2d12383ce1b15eee">obs_cr</a></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememoryhelpermodule.html">memoryhelpermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d">create_mem_path</a></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: filename<span class="comment"> !&lt; filename for reading</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">character(len=*)</span> :: name<span class="comment"> !&lt; exchange name</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: id<span class="comment"> !&lt; id for the exchange</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: m1_id<span class="comment"> !&lt; id for model 1</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: m2_id<span class="comment"> !&lt; id for model 2</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">type</span>(GwfExchangeType), <span class="keywordtype">pointer</span> :: exchange</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">class</span>(BaseModelType), <span class="keywordtype">pointer</span> :: mb</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">class</span>(BaseExchangeType), <span class="keywordtype">pointer</span> :: baseexchange</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: m1_index, m2_index</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">! -- Create a new exchange and add it to the baseexchangelist container</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">allocate</span> (exchange)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    baseexchange =&gt; exchange</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">call </span>addbaseexchangetolist(<a class="code" href="namespacelistsmodule.html#a3e857b53bd777fd84ebcc75f2d7fe273">baseexchangelist</a>, baseexchange)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">! -- Assign id and name</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    exchange%id = id</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    exchange%name = name</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    exchange%memoryPath = <a class="code" href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d">create_mem_path</a>(exchange%name)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">! -- allocate scalars and set defaults</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keyword">call </span>exchange%allocate_scalars()</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    exchange%filename = filename</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    exchange%typename = <span class="stringliteral">&#39;GWF-GWF&#39;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">! -- set gwfmodel1</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    m1_index = model_loc_idx(m1_id)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (m1_index &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      mb =&gt; getbasemodelfromlist(basemodellist, m1_index)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">select type</span> (mb)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordflow">      type is</span> (gwfmodeltype)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        exchange%model1 =&gt; mb</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        exchange%gwfmodel1 =&gt; mb</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    exchange%v_model1 =&gt; <a class="code" href="namespacevirtualmodelmodule.html#abba1d301227ee5a4b869b54fc98e6e59">get_virtual_model</a>(m1_id)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    exchange%is_datacopy = .not. exchange%v_model1%is_local</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">! -- set gwfmodel2</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    m2_index = model_loc_idx(m2_id)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (m2_index &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      mb =&gt; getbasemodelfromlist(basemodellist, m2_index)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">select type</span> (mb)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordflow">      type is</span> (gwfmodeltype)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        exchange%model2 =&gt; mb</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        exchange%gwfmodel2 =&gt; mb</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    exchange%v_model2 =&gt; <a class="code" href="namespacevirtualmodelmodule.html#abba1d301227ee5a4b869b54fc98e6e59">get_virtual_model</a>(m2_id)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">! -- Verify that gwf model1 is of the correct type</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(exchange%gwfmodel1) .and. m1_index &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;Problem with GWF-GWF exchange &#39;</span>, &amp;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        trim(exchange%name), &amp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="stringliteral">&#39;.  First specified GWF Model does not appear to be of the correct type.&#39;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">call </span>store_error(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">! -- Verify that gwf model2 is of the correct type</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> (.not. <span class="keyword">associated</span>(exchange%gwfmodel2) .and. m2_index &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;Problem with GWF-GWF exchange &#39;</span>, &amp;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        trim(exchange%name), &amp;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="stringliteral">&#39;.  Second specified GWF Model does not appear to be of the correct type.&#39;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keyword">call </span>store_error(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">! -- Create the obs package</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceobsmodule.html#a57372fbf202fe90e2d12383ce1b15eee">obs_cr</a>(exchange%obs, exchange%inobs)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacebasemodelmodule_html"><div class="ttname"><a href="namespacebasemodelmodule.html">basemodelmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_base_model_8f90_source.html#l00003">BaseModel.f90:3</a></div></div>
<div class="ttc" id="anamespacelistsmodule_html"><div class="ttname"><a href="namespacelistsmodule.html">listsmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="mf6lists_8f90_source.html#l00001">mf6lists.f90:1</a></div></div>
<div class="ttc" id="anamespacelistsmodule_html_a3e857b53bd777fd84ebcc75f2d7fe273"><div class="ttname"><a href="namespacelistsmodule.html#a3e857b53bd777fd84ebcc75f2d7fe273">listsmodule::baseexchangelist</a></div><div class="ttdeci">type(listtype), public baseexchangelist</div><div class="ttdef"><b>Definition:</b> <a href="mf6lists_8f90_source.html#l00025">mf6lists.f90:25</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html"><div class="ttname"><a href="namespacememoryhelpermodule.html">memoryhelpermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00001">MemoryHelper.f90:1</a></div></div>
<div class="ttc" id="anamespacememoryhelpermodule_html_abe77d18fe02d108d80f414f9fafa592d"><div class="ttname"><a href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d">memoryhelpermodule::create_mem_path</a></div><div class="ttdeci">character(len=lenmempath) function create_mem_path(component, subcomponent, context)</div><div class="ttdoc">returns the path to the memory object</div><div class="ttdef"><b>Definition:</b> <a href="_memory_helper_8f90_source.html#l00021">MemoryHelper.f90:22</a></div></div>
<div class="ttc" id="anamespaceobsmodule_html"><div class="ttname"><a href="namespaceobsmodule.html">obsmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_obs3_8f90_source.html#l00127">Obs3.f90:127</a></div></div>
<div class="ttc" id="anamespaceobsmodule_html_a57372fbf202fe90e2d12383ce1b15eee"><div class="ttname"><a href="namespaceobsmodule.html#a57372fbf202fe90e2d12383ce1b15eee">obsmodule::obs_cr</a></div><div class="ttdeci">subroutine, public obs_cr(obs, inobs)</div><div class="ttdef"><b>Definition:</b> <a href="_obs3_8f90_source.html#l00215">Obs3.f90:216</a></div></div>
<div class="ttc" id="anamespacevirtualmodelmodule_html"><div class="ttname"><a href="namespacevirtualmodelmodule.html">virtualmodelmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_virtual_model_8f90_source.html#l00001">VirtualModel.f90:1</a></div></div>
<div class="ttc" id="anamespacevirtualmodelmodule_html_abba1d301227ee5a4b869b54fc98e6e59"><div class="ttname"><a href="namespacevirtualmodelmodule.html#abba1d301227ee5a4b869b54fc98e6e59">virtualmodelmodule::get_virtual_model</a></div><div class="ttdeci">class(virtualmodeltype) function, pointer, public get_virtual_model(model_id)</div><div class="ttdoc">Returns a virtual model with the specified id.</div><div class="ttdef"><b>Definition:</b> <a href="_virtual_model_8f90_source.html#l00342">VirtualModel.f90:343</a></div></div>
<div class="ttc" id="astructbasemodelmodule_1_1basemodeltype_html"><div class="ttname"><a href="structbasemodelmodule_1_1basemodeltype.html">basemodelmodule::basemodeltype</a></div><div class="ttdef"><b>Definition:</b> <a href="_base_model_8f90_source.html#l00014">BaseModel.f90:14</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a8e8db965870b9878ff9fb5476227b92d_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a8e8db965870b9878ff9fb5476227b92d_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a8e8db965870b9878ff9fb5476227b92d_cgraph" id="anamespacegwfgwfexchangemodule_a8e8db965870b9878ff9fb5476227b92d_cgraph">
<area shape="rect" title="@ brief Create GWF GWF exchange" alt="" coords="5,129,188,171"/>
<area shape="rect" href="namespacebaseexchangemodule.html#a67919a88cc5ebe70bb4a38eaf9ef9144" title=" " alt="" coords="236,5,417,47"/>
<area shape="rect" href="namespacememoryhelpermodule.html#abe77d18fe02d108d80f414f9fafa592d" title="returns the path to the memory object" alt="" coords="243,71,410,112"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="680,107,855,134"/>
<area shape="rect" href="namespacevirtualmodelmodule.html#abba1d301227ee5a4b869b54fc98e6e59" title="Returns a virtual model with the specified id." alt="" coords="249,188,404,229"/>
<area shape="rect" href="namespaceobsmodule.html#a57372fbf202fe90e2d12383ce1b15eee" title=" " alt="" coords="255,254,399,281"/>
<area shape="rect" href="namespacememoryhelpermodule.html#a5405f58247a0962e5449ebc1e4dcff0f" title="Generic routine to check the length of (parts of) the memory address." alt="" coords="465,71,632,112"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="903,107,1041,134"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="1089,67,1257,108"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="1089,132,1257,173"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1305,45,1500,71"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1319,96,1487,137"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a8e8db965870b9878ff9fb5476227b92d_icgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a8e8db965870b9878ff9fb5476227b92d_icgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a8e8db965870b9878ff9fb5476227b92d_icgraph" id="anamespacegwfgwfexchangemodule_a8e8db965870b9878ff9fb5476227b92d_icgraph">
<area shape="rect" title="@ brief Create GWF GWF exchange" alt="" coords="1284,23,1467,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#abb116763d0b57efd5d804f40a52321ee" title="Set the exchanges to be used for the simulation." alt="" coords="1055,23,1236,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#a812a26909f2491fa8fe05d1585bd1728" title="Source the simulation name file." alt="" coords="821,23,1007,65"/>
<area shape="rect" href="namespacesimulationcreatemodule.html#afcbe0fd3c140a3ba4f0a5409e5dc8781" title="Read the simulation name file and initialize the models, exchanges." alt="" coords="592,23,773,65"/>
<area shape="rect" href="namespacemf6coremodule.html#aa847da5116e01f4fad8885b0c4f96757" title="Initialize a simulation." alt="" coords="329,31,544,57"/>
<area shape="rect" href="namespacemf6bmi.html#aa886df822e4ea66c30a97a9060da5de8" title="Initialize the computational core." alt="" coords="107,5,276,32"/>
<area shape="rect" href="namespacemf6coremodule.html#a207819c711610066af1b83ec2a8efef0" title="Main controller." alt="" coords="101,56,281,83"/>
<area shape="rect" href="mf6_8f90.html#aa95bf577752f92b917375902bbb13863" title="MODFLOW 6 main entry point." alt="" coords="5,56,53,83"/>
</map>
</div>

</div>
</div>
<a id="a3a1a567692279b362a294d7b6b8ae971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a1a567692279b362a294d7b6b8ae971">&#9670;&nbsp;</a></span>parse_option()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical(lgp) function gwfgwfexchangemodule::parse_option </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=linelength), intent(in)&#160;</td>
          <td class="paramname"><em>keyword</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">this</td><td>GwfExchangeType </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyword</td><td>the option name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td>for logging </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true when parsed </dd></dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01285">1285</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceinputoutputmodule.html">inputoutputmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>, <a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span>, <span class="keywordtype">intent(in)</span> :: keyword<span class="comment"> !&lt; the option name</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout<span class="comment"> !&lt; for logging</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: parsed<span class="comment"> !&lt; true when parsed</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: fname</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: inobs</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: subkey</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordtype">character(len=:)</span>, <span class="keywordtype">allocatable</span> :: line</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    parsed = .true.</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    sel_opt:<span class="keywordflow">select case</span>(keyword)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;PRINT_FLOWS&#39;</span>)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    this%iprflow = 1</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="stringliteral">&#39;EXCHANGE FLOWS WILL BE PRINTED TO LIST FILES.&#39;</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;SAVE_FLOWS&#39;</span>)</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    this%ipakcb = -1</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="stringliteral">&#39;EXCHANGE FLOWS WILL BE SAVED TO BINARY BUDGET FILES.&#39;</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;ALTERNATIVE_CELL_AVERAGING&#39;</span>)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keyword">call </span>this%parser%GetStringCaps(subkey)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">select case</span> (subkey)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;LOGARITHMIC&#39;</span>)</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      this%icellavg = 1</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;AMT-LMK&#39;</span>)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      this%icellavg = 2</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="keywordflow">    case default</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      errmsg = <span class="stringliteral">&quot;Unknown cell averaging method &#39;&quot;</span>//trim(subkey)//<span class="stringliteral">&quot;&#39;.&quot;</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keyword">call </span>store_error(errmsg)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x,a,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="stringliteral">&#39;CELL AVERAGING METHOD HAS BEEN SET TO: &#39;</span>, trim(subkey)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;VARIABLECV&#39;</span>)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    this%ivarcv = 1</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <span class="stringliteral">&#39;VERTICAL CONDUCTANCE VARIES WITH WATER TABLE.&#39;</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keyword">call </span>this%parser%GetStringCaps(subkey)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">if</span> (subkey == <span class="stringliteral">&#39;DEWATERED&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      this%idewatcv = 1</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="stringliteral">&#39;VERTICAL CONDUCTANCE ACCOUNTS FOR DEWATERED PORTION OF   &#39;</span>// &amp;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="stringliteral">&#39;AN UNDERLYING CELL.&#39;</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;NEWTON&#39;</span>)</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    this%inewton = 1</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <span class="stringliteral">&#39;NEWTON-RAPHSON method used for unconfined cells&#39;</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;GNC6&#39;</span>)</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keyword">call </span>this%parser%GetStringCaps(subkey)</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">if</span> (subkey /= <span class="stringliteral">&#39;FILEIN&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;GNC6 KEYWORD MUST BE FOLLOWED BY &#39;</span>// &amp;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                       <span class="stringliteral">&#39;&quot;FILEIN&quot; then by filename.&#39;</span>)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">if</span> (fname == <span class="stringliteral">&#39;&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;NO GNC6 FILE SPECIFIED.&#39;</span>)</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    this%ingnc = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%ingnc, iout, fname, <span class="stringliteral">&#39;GNC&#39;</span>)</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="stringliteral">&#39;GHOST NODES WILL BE READ FROM &#39;</span>, trim(fname)</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;MVR6&#39;</span>)</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keywordflow">if</span> (this%is_datacopy) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keyword">call </span>this%parser%GetRemainingLine(line)</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keywordflow">exit</span> sel_opt</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keyword">call </span>this%parser%GetStringCaps(subkey)</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">if</span> (subkey /= <span class="stringliteral">&#39;FILEIN&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;MVR6 KEYWORD MUST BE FOLLOWED BY &#39;</span>// &amp;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                       <span class="stringliteral">&#39;&quot;FILEIN&quot; then by filename.&#39;</span>)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keyword">call </span>this%parser%GetString(fname)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span> (fname == <span class="stringliteral">&#39;&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;NO MVR6 FILE SPECIFIED.&#39;</span>)</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    this%inmvr = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(this%inmvr, iout, fname, <span class="stringliteral">&#39;MVR&#39;</span>)</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(4x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="stringliteral">&#39;WATER MOVER INFORMATION WILL BE READ FROM &#39;</span>, trim(fname)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&#39;OBS6&#39;</span>)</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">if</span> (this%is_datacopy) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keyword">call </span>this%parser%GetRemainingLine(line)</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="keywordflow">exit</span> sel_opt</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keyword">call </span>this%parser%GetStringCaps(subkey)</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keywordflow">if</span> (subkey /= <span class="stringliteral">&#39;FILEIN&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="keyword">call </span>store_error(<span class="stringliteral">&#39;OBS8 KEYWORD MUST BE FOLLOWED BY &#39;</span>// &amp;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                       <span class="stringliteral">&#39;&quot;FILEIN&quot; then by filename.&#39;</span>)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    this%obs%active = .true.</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keyword">call </span>this%parser%GetString(this%obs%inputFilename)</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    inobs = <a class="code" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55">getunit</a>()</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52">openfile</a>(inobs, iout, this%obs%inputFilename, <span class="stringliteral">&#39;OBS&#39;</span>)</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    this%obs%inUnitObs = inobs</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="keywordflow">    case default</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    parsed = .false.</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="keywordflow">    end select</span> sel_opt</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a3a1a567692279b362a294d7b6b8ae971_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a3a1a567692279b362a294d7b6b8ae971_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a3a1a567692279b362a294d7b6b8ae971_cgraph" id="anamespacegwfgwfexchangemodule_a3a1a567692279b362a294d7b6b8ae971_cgraph">
<area shape="rect" title="parse option from exchange file" alt="" coords="5,71,188,112"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a535bdfca3d31ebc3a8e4bd5af6890d55" title="Get a free unit number." alt="" coords="236,5,391,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ae97851e3edae8d9809e384058a1a4d52" title="Open a file." alt="" coords="236,71,391,112"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="439,137,613,163"/>
<area shape="rect" href="namespaceinputoutputmodule.html#ac5134655c31ac9beeb4688f504efd801" title="Assign a free unopened unit number." alt="" coords="449,5,603,47"/>
<area shape="rect" href="namespaceinputoutputmodule.html#a8290bae8ca0756e38ce13459dfebe985" title="Convert to upper case." alt="" coords="449,71,603,112"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="661,137,800,163"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="848,96,1016,137"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="848,161,1016,203"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="1064,74,1259,101"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="1077,125,1245,167"/>
</map>
</div>

</div>
</div>
<a id="a8dc7c47193c0fffea6eb6ca80987d93e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dc7c47193c0fffea6eb6ca80987d93e">&#9670;&nbsp;</a></span>qcalc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function gwfgwfexchangemodule::qcalc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iexg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>n2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the flow for the specified exchange and node numbers </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l02011">2011</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="keywordtype">    real</span>(DP) :: qcalc</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iexg</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n1</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: n2</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="comment">! -- Calculate flow between nodes in the two models</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    qcalc = this%cond(iexg) * (this%gwfmodel2%x(n2) - this%gwfmodel1%x(n1))</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2993b4249a14302d26f1bc1613aa681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2993b4249a14302d26f1bc1613aa681">&#9670;&nbsp;</a></span>read_gnc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::read_gnc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read and process ghost nodes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01400">1400</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>, <a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>, <a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: i, nm1, nm2, nmgnc1, nmgnc2</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmterr = &amp;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                                   <span class="stringliteral">&quot;(&#39;EXCHANGE NODES &#39;, i0, &#39; AND &#39;, i0,&quot;</span>// &amp;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                   <span class="stringliteral">&quot;&#39; NOT CONSISTENT WITH GNC NODES &#39;,  &quot;</span>// &amp;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                                   <span class="stringliteral">&quot;i0, &#39; AND &#39;, i0)&quot;</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">! -- If exchange has ghost nodes, then initialize ghost node object</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">!    This will read the ghost node blocks from the gnc input file.</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keyword">call </span>this%gnc%gnc_df(this%gwfmodel1, m2=this%gwfmodel2)</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="comment">! -- Verify gnc is implicit if exchange has Newton Terms</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">if</span> (.not. this%gnc%implicit .and. this%inewton /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;GNC IS EXPLICIT, BUT GWF EXCHANGE HAS ACTIVE NEWTON.&#39;</span>)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;ADD IMPLICIT OPTION TO GNC OR REMOVE NEWTON FROM &#39;</span>// &amp;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                       <span class="stringliteral">&#39;GWF EXCHANGE.&#39;</span>)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>(this%ingnc)</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">! -- Perform checks to ensure GNCs match with GWF-GWF nodes</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordflow">if</span> (this%nexg /= this%gnc%nexg) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(<span class="stringliteral">&#39;NUMBER OF EXCHANGES DOES NOT MATCH NUMBER OF GNCs&#39;</span>)</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>(this%ingnc)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">! -- Go through each entry and confirm</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordflow">do</span> i = 1, this%nexg</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordflow">if</span> (this%nodem1(i) /= this%gnc%nodem1(i) .or. &amp;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;          this%nodem2(i) /= this%gnc%nodem2(i)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        nm1 = this%gwfmodel1%dis%get_nodeuser(this%nodem1(i))</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        nm2 = this%gwfmodel2%dis%get_nodeuser(this%nodem2(i))</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        nmgnc1 = this%gwfmodel1%dis%get_nodeuser(this%gnc%nodem1(i))</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        nmgnc2 = this%gwfmodel2%dis%get_nodeuser(this%gnc%nodem2(i))</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keyword">write</span> (errmsg, fmterr) nm1, nm2, nmgnc1, nmgnc2</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">count_errors</a>() &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a>(this%ingnc)</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">! -- close the file</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keyword">close</span> (this%ingnc)</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacesimmodule_html_a4c46e49de78d4498dd4ec106357775e6"><div class="ttname"><a href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6">simmodule::count_errors</a></div><div class="ttdeci">integer(i4b) function, public count_errors()</div><div class="ttdoc">Return number of errors.</div><div class="ttdef"><b>Definition:</b> <a href="_sim_8f90_source.html#l00058">Sim.f90:59</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_ae2993b4249a14302d26f1bc1613aa681_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_ae2993b4249a14302d26f1bc1613aa681_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_ae2993b4249a14302d26f1bc1613aa681_cgraph" id="anamespacegwfgwfexchangemodule_ae2993b4249a14302d26f1bc1613aa681_cgraph">
<area shape="rect" title="@ brief Read ghost nodes" alt="" coords="5,49,188,90"/>
<area shape="rect" href="namespacesimmodule.html#a4c46e49de78d4498dd4ec106357775e6" title="Return number of errors." alt="" coords="247,5,431,32"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="252,56,427,83"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="236,107,443,133"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="491,81,629,108"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="677,41,845,82"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="677,106,845,147"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="893,19,1088,45"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="907,70,1075,111"/>
</map>
</div>

</div>
</div>
<a id="adc570e5db32482ada98b47690b1c92a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc570e5db32482ada98b47690b1c92a5">&#9670;&nbsp;</a></span>read_mvr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::read_mvr </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read and process movers </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01459">1459</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacegwfmvrmodule.html">gwfmvrmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacegwfmvrmodule.html#a179c35a501fee8f0e98b62f5560f157e">mvr_cr</a></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">! -- Create and initialize the mover object  Here, dis is set to the one</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">!    for gwfmodel1 so that a call to save flows has an associated dis</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">!    object.  Because the conversion flags for the mover are both false,</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">!    the dis object does not convert from reduced to user node numbers.</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">!    So in this case, the dis object is just writing unconverted package</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">!    numbers to the binary budget file.</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacegwfmvrmodule.html#a179c35a501fee8f0e98b62f5560f157e">mvr_cr</a>(this%mvr, this%name, this%inmvr, iout, this%gwfmodel1%dis, &amp;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                iexgmvr=1)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespacegwfmvrmodule_html"><div class="ttname"><a href="namespacegwfmvrmodule.html">gwfmvrmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="gwf3mvr8_8f90_source.html#l00104">gwf3mvr8.f90:104</a></div></div>
<div class="ttc" id="anamespacegwfmvrmodule_html_a179c35a501fee8f0e98b62f5560f157e"><div class="ttname"><a href="namespacegwfmvrmodule.html#a179c35a501fee8f0e98b62f5560f157e">gwfmvrmodule::mvr_cr</a></div><div class="ttdeci">subroutine, public mvr_cr(mvrobj, name_parent, inunit, iout, dis, iexgmvr)</div><div class="ttdef"><b>Definition:</b> <a href="gwf3mvr8_8f90_source.html#l00176">gwf3mvr8.f90:177</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_adc570e5db32482ada98b47690b1c92a5_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_adc570e5db32482ada98b47690b1c92a5_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_adc570e5db32482ada98b47690b1c92a5_cgraph" id="anamespacegwfgwfexchangemodule_adc570e5db32482ada98b47690b1c92a5_cgraph">
<area shape="rect" title="@ brief Read mover" alt="" coords="5,5,188,47"/>
<area shape="rect" href="namespacegwfmvrmodule.html#a179c35a501fee8f0e98b62f5560f157e" title=" " alt="" coords="236,13,411,39"/>
<area shape="rect" href="namespacebudgetmodule.html#a5d07ccf1026ac718f510c44519685c0f" title="@ brief Create a new budget object" alt="" coords="663,13,851,39"/>
<area shape="rect" href="namespacebudgetobjectmodule.html#a0b10034ed28f5a4131a181f960908a1d" title=" " alt="" coords="459,35,615,76"/>
</map>
</div>

</div>
</div>
<a id="a30323e69d2dbc0705ceb951a73385b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30323e69d2dbc0705ceb951a73385b97">&#9670;&nbsp;</a></span>read_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::read_options </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read the options block </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01227">1227</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceconstantsmodule.html">constantsmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceconstantsmodule.html#a060d310ded5535ce2dc85bd1ca1afd3d">linelength</a>, <a class="code" href="namespaceconstantsmodule.html#a9ee3f8405321b057b32648a5dc031e20">lenauxname</a>, <a class="code" href="namespaceconstantsmodule.html#aba95664cbd721a2d72df12ac8bb78da8">dem6</a></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacememorymanagermodule.html">memorymanagermodule</a>, <span class="keywordtype">only</span>: <a class="code" href="interfacememorymanagermodule_1_1mem__allocate.html">mem_allocate</a></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacesimmodule.html">simmodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>, <a class="code" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538">store_error_unit</a></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: iout</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordtype">character(len=LINELENGTH)</span> :: keyword</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordtype">logical</span> :: isfound</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordtype">logical</span> :: endOfBlock</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ierr</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">! -- get options block</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keyword">call </span>this%parser%GetBlock(<span class="stringliteral">&#39;OPTIONS&#39;</span>, isfound, ierr, &amp;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                              supportopenclose=.true., blockrequired=.false.)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">! -- parse options block if detected</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">if</span> (isfound) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;PROCESSING GWF-GWF EXCHANGE OPTIONS&#39;</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keyword">call </span>this%parser%GetNextLine(endofblock)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">if</span> (endofblock) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="keyword">call </span>this%parser%GetStringCaps(keyword)</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="comment">! first parse option in base</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keywordflow">if</span> (this%DisConnExchangeType%parse_option(keyword, iout)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;          cycle</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="comment">! it&#39;s probably ours</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keywordflow">if</span> (this%parse_option(keyword, iout)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;          cycle</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="comment">! unknown option</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        errmsg = <span class="stringliteral">&quot;Unknown GWF-GWF exchange option &#39;&quot;</span>//trim(keyword)//<span class="stringliteral">&quot;&#39;.&quot;</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e">store_error</a>(errmsg)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keyword">call </span>this%parser%StoreErrorUnit()</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="keyword">write</span> (iout, <span class="stringliteral">&#39;(1x,a)&#39;</span>) <span class="stringliteral">&#39;END OF GWF-GWF EXCHANGE OPTIONS&#39;</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="comment">! -- set omega value used for saturation calculations</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">if</span> (this%inewton &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      this%satomega = <a class="code" href="namespaceconstantsmodule.html#aba95664cbd721a2d72df12ac8bb78da8">dem6</a></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">! -- return</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">return</span></div>
<div class="ttc" id="anamespaceconstantsmodule_html_a9ee3f8405321b057b32648a5dc031e20"><div class="ttname"><a href="namespaceconstantsmodule.html#a9ee3f8405321b057b32648a5dc031e20">constantsmodule::lenauxname</a></div><div class="ttdeci">integer(i4b), parameter lenauxname</div><div class="ttdoc">maximum length of a aux variable</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00034">Constants.f90:34</a></div></div>
<div class="ttc" id="anamespaceconstantsmodule_html_aba95664cbd721a2d72df12ac8bb78da8"><div class="ttname"><a href="namespaceconstantsmodule.html#aba95664cbd721a2d72df12ac8bb78da8">constantsmodule::dem6</a></div><div class="ttdeci">real(dp), parameter dem6</div><div class="ttdoc">real constant 1e-6</div><div class="ttdef"><b>Definition:</b> <a href="_constants_8f90_source.html#l00099">Constants.f90:99</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_a30323e69d2dbc0705ceb951a73385b97_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_a30323e69d2dbc0705ceb951a73385b97_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_a30323e69d2dbc0705ceb951a73385b97_cgraph" id="anamespacegwfgwfexchangemodule_a30323e69d2dbc0705ceb951a73385b97_cgraph">
<area shape="rect" title="@ brief Read options" alt="" coords="5,61,188,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="252,43,427,69"/>
<area shape="rect" href="namespacesimmodule.html#a83910ed20af1fec9bdf46cad8c276538" title="Store the file unit number." alt="" coords="236,93,443,120"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="491,68,629,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="677,27,845,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="677,93,845,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="893,5,1088,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="907,57,1075,98"/>
</map>
</div>

</div>
</div>
<a id="a2d141cbfc501a53611ba7dafa3ed815d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d141cbfc501a53611ba7dafa3ed815d">&#9670;&nbsp;</a></span>rewet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::rewet </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i4b), intent(in)&#160;</td>
          <td class="paramname"><em>kiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if rewetting should propagate from one model to another </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l01485">1485</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="comment">! -- modules</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacetdismodule.html">tdismodule</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a>, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="comment">! -- dummy</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordtype">integer(I4B)</span>, <span class="keywordtype">intent(in)</span> :: kiter</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">! -- local</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: iexg</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: n, m</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ibdn, ibdm</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: ihc</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="keywordtype">    real</span>(DP) :: hn, hm</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordtype">integer(I4B)</span> :: irewet</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordtype">character(len=30)</span> :: nodestrn, nodestrm</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: fmtrwt = &amp;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="stringliteral">&quot;(1x, &#39;CELL &#39;,A,&#39; REWET FROM GWF MODEL &#39;,A,&#39; CELL &#39;,A, &amp;</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="stringliteral"></span><span class="stringliteral">       &amp;&#39; FOR ITER. &#39;,I0, &#39; STEP &#39;,I0, &#39; PERIOD &#39;, I0)&quot;</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">! -- Use model 1 to rewet model 2 and vice versa</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keywordflow">do</span> iexg = 1, this%nexg</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      n = this%nodem1(iexg)</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      m = this%nodem2(iexg)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      hn = this%gwfmodel1%x(n)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      hm = this%gwfmodel2%x(m)</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      ibdn = this%gwfmodel1%ibound(n)</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      ibdm = this%gwfmodel2%ibound(m)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      ihc = this%ihc(iexg)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      <span class="keyword">call </span>this%gwfmodel1%npf%rewet_check(kiter, n, hm, ibdm, ihc, &amp;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                                          this%gwfmodel1%x, irewet)</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <span class="keywordflow">if</span> (irewet == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keyword">call </span>this%gwfmodel1%dis%noder_to_string(n, nodestrn)</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keyword">call </span>this%gwfmodel2%dis%noder_to_string(m, nodestrm)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="keyword">write</span> (this%gwfmodel1%iout, fmtrwt) trim(nodestrn), &amp;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;          trim(this%gwfmodel2%name), trim(nodestrm), kiter, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="keyword">call </span>this%gwfmodel2%npf%rewet_check(kiter, m, hn, ibdn, ihc, &amp;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                          this%gwfmodel2%x, irewet)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keywordflow">if</span> (irewet == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keyword">call </span>this%gwfmodel1%dis%noder_to_string(n, nodestrm)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keyword">call </span>this%gwfmodel2%dis%noder_to_string(m, nodestrn)</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="keyword">write</span> (this%gwfmodel2%iout, fmtrwt) trim(nodestrn), &amp;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;          trim(this%gwfmodel1%name), trim(nodestrm), kiter, <a class="code" href="namespacetdismodule.html#ad3443c7d7da2a67a75174c39c6d40c84">kstp</a>, <a class="code" href="namespacetdismodule.html#ae84d6ee69d7bba12d20a6255a398935b">kper</a></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="comment">! -- Return</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ee21a7bd938104b56658f93949ef2f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ee21a7bd938104b56658f93949ef2f3">&#9670;&nbsp;</a></span>use_interface_model()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical(lgp) function gwfgwfexchangemodule::use_interface_model </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true when interface model should be used </dd></dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l02078">2078</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: use_im<span class="comment"> !&lt; true when interface model should be used</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; </div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    use_im = this%DisConnExchangeType%use_interface_model()</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    use_im = use_im .or. (this%ixt3d &gt; 0)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="aabc561aefd93cdde87725dd7097e45f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabc561aefd93cdde87725dd7097e45f6">&#9670;&nbsp;</a></span>validate_exchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwfgwfexchangemodule::validate_exchange </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structgwfgwfexchangemodule_1_1gwfexchangetype.html">gwfexchangetype</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>GwfExchangeType </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_gwf_gwf_exchange_8f90_source.html#l00289">289</a> of file <a class="el" href="_gwf_gwf_exchange_8f90_source.html">GwfGwfExchange.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordtype">class</span>(GwfExchangeType) :: this<span class="comment"> !&lt;  GwfExchangeType</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">logical(LGP)</span> :: has_k22, has_spdis, has_vsc</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">! Periodic boundary condition in exchange don&#39;t allow XT3D (=interface model)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%model1, this%model2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">if</span> (this%ixt3d &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;GWF-GWF exchange &#39;</span>, trim(this%name), &amp;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <span class="stringliteral">&#39; is a periodic boundary condition which cannot&#39;</span>// &amp;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          <span class="stringliteral">&#39; be configured with XT3D&#39;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keyword">call </span>store_error(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">! XT3D needs angle information</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (this%ixt3d &gt; 0 .and. this%ianglex == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;GWF-GWF exchange &#39;</span>, trim(this%name), &amp;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="stringliteral">&#39; requires that ANGLDEGX be specified as an&#39;</span>// &amp;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="stringliteral">&#39; auxiliary variable because XT3D is enabled&#39;</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keyword">call </span>store_error(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">! determine if specific functionality is demanded,</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">! in model 1 or model 2 (in parallel, only one of</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">! the models is checked, but the exchange is duplicated)</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    has_k22 = .false.</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    has_spdis = .false.</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    has_vsc = .false.</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      has_k22 = (this%gwfmodel1%npf%ik22 /= 0)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      has_spdis = (this%gwfmodel1%npf%icalcspdis /= 0)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      has_vsc = (this%gwfmodel1%npf%invsc /= 0)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(this%gwfmodel2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      has_k22 = has_k22 .or. (this%gwfmodel2%npf%ik22 /= 0)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      has_spdis = has_spdis .or. (this%gwfmodel2%npf%icalcspdis /= 0)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      has_vsc = has_vsc .or. (this%gwfmodel2%npf%invsc /= 0)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">! If horizontal anisotropy is in either model1 or model2,</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">! ANGLDEGX must be provided as an auxiliary variable for this</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">! GWF-GWF exchange (this%ianglex &gt; 0).</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (has_k22) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">if</span> (this%ianglex == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;GWF-GWF exchange &#39;</span>, trim(this%name), &amp;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          <span class="stringliteral">&#39; requires that ANGLDEGX be specified as an&#39;</span>// &amp;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          <span class="stringliteral">&#39; auxiliary variable because K22 was specified&#39;</span>// &amp;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <span class="stringliteral">&#39; in one or both groundwater models.&#39;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keyword">call </span>store_error(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">! If specific discharge is needed for model1 or model2,</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">! ANGLDEGX must be provided as an auxiliary variable for this</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">! GWF-GWF exchange (this%ianglex &gt; 0).</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> (has_spdis) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">if</span> (this%ianglex == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;GWF-GWF exchange &#39;</span>, trim(this%name), &amp;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          <span class="stringliteral">&#39; requires that ANGLDEGX be specified as an&#39;</span>// &amp;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          <span class="stringliteral">&#39; auxiliary variable because specific discharge&#39;</span>// &amp;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          <span class="stringliteral">&#39; is being calculated in one or both&#39;</span>// &amp;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          <span class="stringliteral">&#39; groundwater models.&#39;</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keyword">call </span>store_error(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">if</span> (this%icdist == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;GWF-GWF exchange &#39;</span>, trim(this%name), &amp;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          <span class="stringliteral">&#39; requires that CDIST be specified as an&#39;</span>// &amp;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          <span class="stringliteral">&#39; auxiliary variable because specific discharge&#39;</span>// &amp;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          <span class="stringliteral">&#39; is being calculated in one or both&#39;</span>// &amp;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          <span class="stringliteral">&#39; groundwater models.&#39;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">call </span>store_error(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">! If viscosity is on in either model, then terminate with an</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">! error as viscosity package doesn&#39;t work yet with exchanges.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (has_vsc) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keyword">write</span> (errmsg, <span class="stringliteral">&#39;(3a)&#39;</span>) <span class="stringliteral">&#39;GWF-GWF exchange &#39;</span>, trim(this%name), &amp;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="stringliteral">&#39; requires that the Viscosity Package is inactive&#39;</span>// &amp;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="stringliteral">&#39; in both of the connected models.&#39;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keyword">call </span>store_error(errmsg, terminate=.true.)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacegwfgwfexchangemodule_aabc561aefd93cdde87725dd7097e45f6_cgraph.png" border="0" usemap="#anamespacegwfgwfexchangemodule_aabc561aefd93cdde87725dd7097e45f6_cgraph" alt=""/></div>
<map name="anamespacegwfgwfexchangemodule_aabc561aefd93cdde87725dd7097e45f6_cgraph" id="anamespacegwfgwfexchangemodule_aabc561aefd93cdde87725dd7097e45f6_cgraph">
<area shape="rect" title="validate exchange data after reading" alt="" coords="5,61,188,102"/>
<area shape="rect" href="namespacesimmodule.html#a21870712a1166225fdcd5b60bffb353e" title="Store error message." alt="" coords="236,68,411,95"/>
<area shape="rect" href="namespacesimmodule.html#a0be97214c1d4fcf42bc4ddc27b111b61" title="Stop the simulation." alt="" coords="459,68,597,95"/>
<area shape="rect" href="namespacesimmodule.html#aa04e734eebf95836b2f37839b65bcae9" title="Print the final messages." alt="" coords="645,27,813,69"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a3af5fcf48dcd06255d9bc07f6a25db59" title="Subroutine to stop the program." alt="" coords="645,93,813,134"/>
<area shape="rect" href="namespacesimmodule.html#a5feb4a39fb3f3dc66c03cc13b11e2297" title="Close all open files." alt="" coords="861,5,1056,32"/>
<area shape="rect" href="namespacegenericutilitiesmodule.html#a34492cca79f70174fd015808be8b7ebf" title="Write simulation message." alt="" coords="875,57,1043,98"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegwfgwfexchangemodule.html">gwfgwfexchangemodule</a></li>
    <li class="footer">Generated on Wed Mar 15 2023 17:20:58 for MODFLOW 6 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
